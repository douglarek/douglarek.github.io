<!doctype html><html lang=zh><head><title>Go è°šè¯­ &ndash; Code talks</title><meta name=viewport content="width=device-width,initial-scale=1"><meta charset=UTF-8><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.4/css/academicons.min.css integrity="sha512-IW0nhlW5MgNydsXJO40En2EoCkTTjZhI3yuODrZIc8cQ4h1XcF53PsqDHa09NqnkXuIe0Oiyyj171BqZFwISBw==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=/css/palettes/base16-dark.css><link rel=stylesheet href=/css/risotto.css><link rel=stylesheet href=/css/custom.css><link rel=icon href=/favicon.ico><meta property="og:title" content="Go è°šè¯­ &ndash; Code talks"><meta property="og:url" content="/post/go-proverbs/"><meta property="og:locale" content="zh-CN"><script async src="https://www.googletagmanager.com/gtag/js?id=G-4TVXFV2XZM%20"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-4TVXFV2XZM ")}</script></head><body><div class=page><header class=page__header><nav class="page__nav main-nav"><ul><li class=nomarker><h1 class=page__logo><a href=/ class=page__logo-inner>Code talks</a></h1></li><li class=main-nav__item><a class=nav-main-item href=/post title>Posts</a></li><li class=main-nav__item><a class=nav-main-item href=/tags title>Tags</a></li><li class=main-nav__item><a class=nav-main-item href=https://github.com/douglarek title>GitHub</a></li></ul></nav></header><section class=page__body><header class=content__header><h1>Go è°šè¯­</h1><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6649330439620894" crossorigin=anonymous></script></header><div class=content__body><p>æœ¬æ–‡ç¿»è¯‘è‡ª <a href=http://go-proverbs.github.io/>Go Proverbs</a>, è„±èƒäº Rob Pike åœ¨ <a href="https://www.youtube.com/watch?v=PAAkCSZUG1c">Gopherfest SV 2015</a> çš„æ¼”è®²ï¼Œç‰ˆæƒå½’åŸä½œè€…æ‰€æœ‰ã€‚</p><h2 id=ä¸è¦é€šè¿‡å…±äº«å†…å­˜è¿›è¡Œé€šä¿¡-é€šè¿‡é€šä¿¡å…±äº«å†…å­˜-don>ä¸è¦é€šè¿‡å…±äº«å†…å­˜è¿›è¡Œé€šä¿¡, é€šè¿‡é€šä¿¡å…±äº«å†…å­˜ (<a href="https://www.bilibili.com/video/av18889438/?t=2m48s">Don&rsquo;t communicate by sharing memory, share memory by communicating</a>)</h2><p>ä¼ ç»Ÿçš„çº¿ç¨‹æ¨¡å‹ï¼ˆé€šå¸¸åœ¨ç¼–å†™ Java, C++ å’Œ Python ç¨‹åºæ—¶ä½¿ç”¨ï¼‰è¦æ±‚ç¨‹åºå‘˜ä½¿ç”¨å…±äº«å†…å­˜åœ¨çº¿ç¨‹ä¹‹é—´è¿›è¡Œé€šä¿¡. é€šå¸¸, å…±äº«æ•°æ®ç»“æ„å—é”ä¿æŠ¤, çº¿ç¨‹å°†äº‰å¤ºè¿™äº›é”è®¿é—®æ•°æ®, åœ¨æŸäº›æƒ…å†µä¸‹, é€šè¿‡ä½¿ç”¨ Python çš„ Queue ç­‰çº¿ç¨‹å®‰å…¨çš„æ•°æ®ç»“æ„å¯ä»¥ä½¿è¿™å˜å¾—æ›´å®¹æ˜“.</p><p>Go çš„å¹¶å‘åŸè¯­ (goroutines å’Œ channels) ä¸ºæ„é€ å¹¶å‘è½¯ä»¶æä¾›äº†ä¸€ç§ä¼˜é›…è€Œç‹¬ç‰¹çš„æ‰‹æ®µ. (è¿™äº›æ¦‚å¿µæœ‰ä¸€ä¸ªæœ‰è¶£çš„å†å², è¦ä» C.A.R.Hoare çš„é€šä¿¡é¡ºåºè¿›ç¨‹è¯´èµ·.) Go é¼“åŠ±ä½¿ç”¨ channels åœ¨ goroutines ä¹‹é—´ä¼ é€’å¯¹æ•°æ®çš„å¼•ç”¨, è€Œä¸æ˜¯æ˜¾å¼åœ°ä½¿ç”¨é”æ¥è°ƒè§£å¯¹å…±äº«æ•°æ®çš„è®¿é—®. è¿™ç§æ–¹æ³•ç¡®ä¿åªæœ‰ä¸€ä¸ª goroutine å¯ä»¥åœ¨ç»™å®šçš„æ—¶é—´è®¿é—®æ•°æ®. è¿™ä¸ªæ¦‚å¿µæ€»ç»“åœ¨ Effective Go æ–‡æ¡£ä¸­ (ä»»ä½• Go ç¨‹åºå‘˜éƒ½å¿…é¡»é˜…è¯»).</p><p>Go å®˜æ–¹åšå®¢ä¸­æœ‰ä¸€ç¯‡æ–‡ç« å¯¹è¯¥è°šè¯­è§£è¯», å¯ä»¥å‚è§<a href=https://blog.golang.org/share-memory-by-communicating>åŸæ–‡</a>.</p><h2 id=å¹¶å‘ä¸æ˜¯å¹¶è¡Œ-concurrency-is-not-parallelism>å¹¶å‘ä¸æ˜¯å¹¶è¡Œ (<a href="https://www.bilibili.com/video/av18889438/?t=3m42s">Concurrency is not parallelism</a>)</h2><p>å½“äººä»¬å¬åˆ° <em>å¹¶å‘</em> è¿™ä¸ªè¯çš„æ—¶å€™, ä»–ä»¬ç»å¸¸ä¼šæƒ³åˆ°å¹¶è¡Œ, è¿™æ˜¯ä¸€ä¸ªç›¸å…³çš„, ä½†éå¸¸ç‹¬ç‰¹çš„æ¦‚å¿µ. åœ¨ç¼–ç¨‹ä¸­, å¹¶å‘æ˜¯ç‹¬ç«‹æ‰§è¡Œçš„è¿›ç¨‹çš„ç»„æˆ, è€Œå¹¶è¡Œåˆ™æ˜¯ (å¯èƒ½ç›¸å…³çš„) è®¡ç®—çš„åŒæ—¶æ‰§è¡Œ. å¹¶å‘æ˜¯ä¸€æ¬¡å¤„ç†å¾ˆå¤šäº‹æƒ…. å¹¶è¡Œæ˜¯ä¸€æ¬¡åšå¾ˆå¤šäº‹æƒ….</p><h2 id=channels-é‡æ’åº-äº’æ–¥é‡ä¸²è¡ŒåŒ–-channels-orchestrate-mutexes-serialize>Channels é‡æ’åº; äº’æ–¥é‡ä¸²è¡ŒåŒ– (<a href="https://www.bilibili.com/video/av18889438/?t=4m20s">Channels orchestrate; mutexes serialize</a>)</h2><p>è¿™ä¸ªçœ‹ä¸­æ–‡ï¼ˆç¿»è¯‘å¾…å•†æ¦·ï¼‰æ˜¯ä¸æ˜¯ä¸€è„¸æ‡µ (è™½ç„¶è‹±æ–‡ä¹Ÿçœ‹ä¸æ‡‚) ? å…¶å®åˆ†å·å‰åè¯´çš„æ˜¯ä¸€ä¸ªæ„æ€, è¯¥è°šè¯­æŒ‰æˆ‘çš„ä¸ªäººç†è§£å¯ä»¥ç”¨ go ç¨‹åº (æ¥è‡ª <a href=https://github.com/golang/tour/blob/master/content/concurrency/channels.go>go tour</a>) è§£é‡Šæˆå¦‚ä¸‹:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#e6db74>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>sum</span>(<span style=color:#a6e22e>s</span> []<span style=color:#66d9ef>int</span>, <span style=color:#a6e22e>c</span> <span style=color:#66d9ef>chan</span> <span style=color:#66d9ef>int</span>) {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>sum</span> <span style=color:#f92672>:=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>for</span> <span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>v</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>range</span> <span style=color:#a6e22e>s</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>sum</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>v</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>c</span> <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>sum</span> <span style=color:#75715e>// æ­¤å¤„å¦‚æœæ”¹æˆäº’æ–¥é‡ä¸€æ ·å¯ä»¥åšåˆ°</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>s</span> <span style=color:#f92672>:=</span> []<span style=color:#66d9ef>int</span>{<span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>8</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>0</span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>c</span> <span style=color:#f92672>:=</span> make(<span style=color:#66d9ef>chan</span> <span style=color:#66d9ef>int</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>go</span> <span style=color:#a6e22e>sum</span>(<span style=color:#a6e22e>s</span>[:len(<span style=color:#a6e22e>s</span>)<span style=color:#f92672>/</span><span style=color:#ae81ff>2</span>], <span style=color:#a6e22e>c</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>go</span> <span style=color:#a6e22e>sum</span>(<span style=color:#a6e22e>s</span>[len(<span style=color:#a6e22e>s</span>)<span style=color:#f92672>/</span><span style=color:#ae81ff>2</span>:], <span style=color:#a6e22e>c</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>x</span>, <span style=color:#a6e22e>y</span> <span style=color:#f92672>:=</span> <span style=color:#f92672>&lt;-</span><span style=color:#a6e22e>c</span>, <span style=color:#f92672>&lt;-</span><span style=color:#a6e22e>c</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>x</span>, <span style=color:#a6e22e>y</span>, <span style=color:#a6e22e>x</span><span style=color:#f92672>+</span><span style=color:#a6e22e>y</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=æ¥å£è¶Šå¤§-æŠ½è±¡è¶Šå¼±-the-bigger-the-interface-the-weaker-the-abstraction>æ¥å£è¶Šå¤§, æŠ½è±¡è¶Šå¼± (<a href="https://www.bilibili.com/video/av18889438/?t=5m17s">The bigger the interface, the weaker the abstraction</a>)</h2><p>æ¥å£èƒŒåçš„æ¦‚å¿µæ˜¯é€šè¿‡å°†å¯¹è±¡çš„è¡Œä¸ºæŠ½è±¡ä¸ºç®€å•çš„å¥‘çº¦æ¥å…è®¸é‡ç”¨æ€§. è™½ç„¶æ¥å£ä¸æ˜¯ Go ä¸“æœ‰çš„, ä½†ç”±äº Go æ¥å£é€šå¸¸è¶‹å‘äºå°å‹åŒ–, Go ç¨‹åºå‘˜æ‰å¹¿æ³›ä½¿ç”¨å®ƒä»¬. é€šå¸¸æƒ…å†µä¸‹, ä¸€ä¸ªæ¥å£åªé™äºä¸€åˆ°ä¸¤ä¸ªæ–¹æ³•.</p><p>Go io åŒ…æ¥å£å°±æ˜¯å…¸å‹çš„ä¾‹å­.</p><h2 id=å……åˆ†åˆ©ç”¨é›¶å€¼-make-the-zero-value-useful>å……åˆ†åˆ©ç”¨é›¶å€¼ (<a href="https://www.bilibili.com/video/av18889438/?t=6m25s">Make the zero value useful</a>)</h2><p>é›¶å€¼çš„å…¸å‹ä¾‹å­å¦‚ bytes.Buffer å’Œ sync.Mutex:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>buf</span> <span style=color:#a6e22e>bytes</span>.<span style=color:#a6e22e>Buffer</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>buf</span>.<span style=color:#a6e22e>Write</span>([]byte(<span style=color:#e6db74>&#34;hello&#34;</span>))
</span></span><span style=display:flex><span><span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>buf</span>.<span style=color:#a6e22e>String</span>())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>mu</span> <span style=color:#a6e22e>sync</span>.<span style=color:#a6e22e>Mutex</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>mu</span>.<span style=color:#a6e22e>Lock</span>()
</span></span><span style=display:flex><span><span style=color:#a6e22e>mu</span>.<span style=color:#a6e22e>Unlock</span>()
</span></span></code></pre></div><p>è¿™æ ·çœ‹èµ·æ¥æ˜¯ä¸æ˜¯æ„Ÿè§‰ä¸€ç‚¹ç”¨æ²¡æœ‰ ? å¦‚æœè¿™æ ·å‘¢ ?</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Map</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>mu</span> <span style=color:#a6e22e>sync</span>.<span style=color:#a6e22e>RWMutex</span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// ...</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>m</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>Map</span>) <span style=color:#a6e22e>Set</span>(<span style=color:#a6e22e>k</span>, <span style=color:#a6e22e>v</span> <span style=color:#66d9ef>interface</span>{}) {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>mu</span>.<span style=color:#a6e22e>Lock</span>()
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>defer</span> <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>mu</span>.<span style=color:#a6e22e>Unlock</span>()
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>m</span> <span style=color:#f92672>==</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>m</span> = make(<span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>interface</span>{}]<span style=color:#66d9ef>interface</span>{})
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>m</span>[<span style=color:#a6e22e>k</span>] = <span style=color:#a6e22e>v</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=interface-è¨€ä¹‹æ— ç‰©-interface-says-nothing>interface{} è¨€ä¹‹æ— ç‰© (<a href="https://www.bilibili.com/video/av18889438/?t=7m36s">interface{} says nothing</a>)</h2><p>è¯¥è°šè¯­ä¸æ˜¯è¯´ interface {} ä¸ä»£è¡¨ä»»ä½•ä¸œè¥¿, è€Œæ˜¯è¯´è¯¥ç±»å‹æ— é™æ€æ£€æŸ¥ä»¥åŠè°ƒç”¨æ—¶ä¿è¯, æ¯”å¦‚ä½ çš„ func æ¥æ”¶ä¸€ä¸ª interface{} ç±»å‹, ä½ å†™çš„æ—¶å€™æ˜¯å¯ç”¨çš„, ä½†æ˜¯æŸä¸ªæ—¶é—´ä½ è¿›è¡Œäº†ä»£ç é‡æ„å¯èƒ½åæ‰äº†.</p><h2 id=gofmt-çš„é£æ ¼æ²¡æœ‰äººå–œæ¬¢-ä½†æ˜¯-gofmt-æ˜¯æ¯ä¸ªäººçš„æœ€çˆ±-gofmt>Gofmt çš„é£æ ¼æ²¡æœ‰äººå–œæ¬¢, ä½†æ˜¯ gofmt æ˜¯æ¯ä¸ªäººçš„æœ€çˆ± (<a href="https://www.bilibili.com/video/av18889438/?t=8m43s">Gofmt&rsquo;s style is no one&rsquo;s favorite, yet gofmt is everyone&rsquo;s favorite</a>)</h2><p>è¯¥è°šè¯­å‘Šè¯‰æˆ‘ä»¬å°‘äº›é£æ ¼ä¹‹äº‰, ç”¨è¿™äº›æ—¶é—´å¤šå†™ä»£ç .</p><h2 id=å°å¤åˆ¶å¥½è¿‡å°ä¾èµ–-a-little-copying-is-better-than-a-little-dependency>å°å¤åˆ¶å¥½è¿‡å°ä¾èµ– (<a href="https://www.bilibili.com/video/av18889438/?t=9m28s">A little copying is better than a little dependency</a>)</h2><p>ç®€å•è¯´å°±æ˜¯å¦‚æœä½ å¯ä»¥æ‰‹åŠ¨æ’¸å°å¿«ä»£ç å°±ä¸è¦å¯¼å…¥ä¸€ä¸ªåº“å»åš, æ¯”å¦‚ UUID:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#75715e>// see: https://groups.google.com/d/msg/golang-nuts/d0nF_k4dSx4/rPGgfXv6QCoJ</span>
</span></span><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> (
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;os&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>f</span>, <span style=color:#a6e22e>_</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Open</span>(<span style=color:#e6db74>&#34;/dev/urandom&#34;</span>) <span style=color:#75715e>// æ¼”ç¤ºç”¨å¿½ç•¥ errcheck</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>b</span> <span style=color:#f92672>:=</span> make([]<span style=color:#66d9ef>byte</span>, <span style=color:#ae81ff>16</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>f</span>.<span style=color:#a6e22e>Read</span>(<span style=color:#a6e22e>b</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>f</span>.<span style=color:#a6e22e>Close</span>()
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>uuid</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Sprintf</span>(<span style=color:#e6db74>&#34;%x-%x-%x-%x-%x&#34;</span>, <span style=color:#a6e22e>b</span>[<span style=color:#ae81ff>0</span>:<span style=color:#ae81ff>4</span>], <span style=color:#a6e22e>b</span>[<span style=color:#ae81ff>4</span>:<span style=color:#ae81ff>6</span>], <span style=color:#a6e22e>b</span>[<span style=color:#ae81ff>6</span>:<span style=color:#ae81ff>8</span>], <span style=color:#a6e22e>b</span>[<span style=color:#ae81ff>8</span>:<span style=color:#ae81ff>10</span>], <span style=color:#a6e22e>b</span>[<span style=color:#ae81ff>10</span>:])
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>uuid</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>è™½ç„¶æœ‰ä¸€å †å†™å¥½çš„ UUID åº“, å½“ä½ ä»…ä»…éœ€è¦ä¸€ä¸ª UUID v4 å®ç°.</p><h2 id=ç³»ç»Ÿè°ƒç”¨å¿…é¡»å§‹ç»ˆä½¿ç”¨æ„å»ºæ ‡ç­¾ä¿è¯-syscall-must-always-be-guarded-with-build-tags>ç³»ç»Ÿè°ƒç”¨å¿…é¡»å§‹ç»ˆä½¿ç”¨æ„å»ºæ ‡ç­¾ä¿è¯ (<a href="https://www.bilibili.com/video/av18889438/?t=11m10s">Syscall must always be guarded with build tags</a>)</h2><p>ä¸åŒçš„ç³»ç»Ÿ (*NIX, Windows) è°ƒç”¨å¯¼è‡´ä½ åŒä¸€ä¸ª func (å®ç°å¹¶ä¸ä¸€æ ·) å¯èƒ½éœ€è¦åœ¨ä¸åŒçš„ç³»ç»Ÿä¸Šæ„å»ºæ‰èƒ½å¾—åˆ°ä½ æƒ³è¦çš„ç»“æœ. ç®€å•è¯´å°±æ˜¯ç³»ç»Ÿè°ƒç”¨ä¸å¯ç§»æ¤æ‰è¿™ä¹ˆå¹². ç¤ºä¾‹å¯å‚è§ Go æ ‡å‡†åº“ syscall.</p><h2 id=cgo-å¿…é¡»å§‹ç»ˆä½¿ç”¨æ„å»ºæ ‡ç­¾ä¿è¯-cgo-must-always-be-guarded-with-build-tags>Cgo å¿…é¡»å§‹ç»ˆä½¿ç”¨æ„å»ºæ ‡ç­¾ä¿è¯ (<a href="https://www.bilibili.com/video/av18889438/?t=11m53s">Cgo must always be guarded with build tags</a>)</h2><p>åŸºæœ¬ä¸ŠåŸå› åŒä¸Šä¸€æ¡.</p><h2 id=cgo-ä¸æ˜¯-go-cgo-is-not-go>Cgo ä¸æ˜¯ Go (<a href="https://www.bilibili.com/video/av18889438/?t=12m37s">Cgo is not Go</a>)</h2><p>å¦‚æœå¯èƒ½ä¸è¦ç”¨ Cgo. è¿™é‡Œæœ‰ç¯‡<a href=https://dave.cheney.net/2016/01/18/cgo-is-not-go>æ–‡ç« </a>è¯´æ˜äº†ä¸ºä»€ä¹ˆ.</p><h2 id=unsafe-åŒ…æ— ä¿è¯-with-the-unsafe-package-there-are-no-guarantees>unsafe åŒ…æ— ä¿è¯ (With the unsafe package there are no guarantees)</h2><p>åŒ…å¦‚å…¶å, ä¸å®‰å…¨. ä½ å¯ä»¥ä½¿ç”¨ unsafe åŒ…å¦‚æœä½ å‡†å¤‡å¥½äº†æœ‰ä¸€å¤©å®ƒä¼šåæ‰.</p><h2 id=æ¸…æ™°å¥½è¿‡èªæ˜-clear-is-better-than-clever>æ¸…æ™°å¥½è¿‡èªæ˜ (<a href="https://www.bilibili.com/video/av18889438/?t=14m35s">Clear is better than clever</a>)</h2><p>Rob Pike åœ¨ä»–ä¸åˆ«äººåˆè‘—çš„ &lt;<a href=https://item.jd.com/11836053.html>ç¨‹åºè®¾è®¡å®è·µ</a>> ä¸­å†™åˆ°: &ldquo;å†™æ¸…æ™°çš„ä»£ç , ä¸è¦å†™èªæ˜çš„ä»£ç &rdquo;.</p><h2 id=åå°„æ°¸è¿œä¸æ˜¯æ¸…æ™°çš„-reflection-is-never-clear>åå°„æ°¸è¿œä¸æ˜¯æ¸…æ™°çš„ (<a href="https://www.bilibili.com/video/av18889438/?t=15m22s">Reflection is never clear</a>)</h2><p>å¾ˆå¤šäººåœ¨ Stackoverflow ä¸ŠæŠ±æ€¨ Go çš„åå°„ä¸å·¥ä½œ, å› ä¸ºé‚£ä¸æ˜¯ä¸ºä½ å‡†å¤‡çš„ğŸ˜‚! åªæœ‰å¾ˆå°‘å¾ˆå°‘çš„äººåº”è¯¥ç”¨åå°„è¿™ä¸ªéå¸¸å¼ºå¤§è€Œåˆéå¸¸éš¾çš„ç‰¹æ€§. æ–°æ‰‹åº”è¯¥è¿œç¦»åå°„å’Œ interface{}.</p><h2 id=é”™è¯¯ä¹Ÿæ˜¯ä¸€ç§å€¼-errors-are-values>é”™è¯¯ä¹Ÿæ˜¯ä¸€ç§å€¼ (<a href="https://www.bilibili.com/video/av18889438/?t=16m13s">Errors are values</a>)</h2><p>å€¼å¯ä»¥è¢«ç¼–ç¨‹, å¹¶ä¸”ç”±äºé”™è¯¯æ˜¯å€¼, æ‰€ä»¥é”™è¯¯å¯ä»¥è¢«ç¼–ç¨‹. Go å®˜æ–¹åšå®¢æœ‰å¯¹æ­¤çš„<a href=https://blog.golang.org/errors-are-values>è§£è¯»</a>.</p><h2 id=ä¸è¦æ­¢æ­¥äºæ£€æŸ¥é”™è¯¯è€Œè¦ä¼˜é›…çš„å¤„ç†-don>ä¸è¦æ­¢æ­¥äºæ£€æŸ¥é”™è¯¯è€Œè¦ä¼˜é›…çš„å¤„ç† (<a href="https://www.bilibili.com/video/av18889438/?t=17m25s">Don&rsquo;t just check errors, handle them gracefully</a>)</h2><p>Dave Cheney æœ‰ç¯‡<a href=https://dave.cheney.net/2016/04/27/dont-just-check-errors-handle-them-gracefully>åšå®¢</a>è¯¦ç»†è§£è¯»äº†è¯¥è°šè¯­.</p><h2 id=è®¾è®¡æ¶æ„-å‘½åç»„ä»¶-è®°å½•ç»†èŠ‚-design-the-architecture-name-the-components-document-the-details>è®¾è®¡æ¶æ„, å‘½åç»„ä»¶, è®°å½•ç»†èŠ‚ (<a href="https://www.bilibili.com/video/av18889438/?t=18m09s">Design the architecture, name the components, document the details</a>)</h2><p>å½“ä½ å†™ä¸€ä¸ªå¤§å‹ç³»ç»Ÿçš„æ—¶å€™, ä½ æŠŠå®ƒè®¾è®¡æˆä¸€ç§ç»“æ„åŒ–çš„ä¸œè¥¿. æƒ³è±¡ç»„ä»¶çš„æ¯ä¸€ä¸ªéƒ¨åˆ†å¹¶è¡Œå·¥ä½œ, ä¸ºä¸åŒçš„ç»„ä»¶èµ·å¥½çš„åå­—, å› ä¸ºè¿™äº›åå­—ä¼šå‡ºç°åœ¨ç¨¿çº¸ä¸Š.</p><p>æ‹¿ Go ç¨‹åºæ¥è¯´, å¦‚æœåå­—ä¸é”™, ç»„ä»¶å°±å¥½ç†è§£, é‚£ä¹ˆç¨‹åºçš„ç»“æ„è®¾è®¡å°±ä¼šæ¸…æ™°, ç¨‹åºä¼šæ„Ÿè§‰å¾ˆè‡ªç„¶.</p><p>ä½†æ˜¯è¿˜æœ‰å¾ˆå¤šä¸œè¥¿ä½ éœ€è¦è§£é‡Š, æ‰€ä»¥è¿™äº›æ˜¯ä½ éœ€è¦è§£é‡Šçš„ç»†èŠ‚. ä½†æ˜¯å‘½åä¼šå¸®åŠ©ä½ è§£é‡Šå¾ˆå¤§ä¸€éƒ¨åˆ†è®¾è®¡. ç»†èŠ‚åªæ˜¯å¡«è¡¥ææ–™çš„ç¼ºå£å¯èƒ½ç”¨æ¥ä¸ºç”¨æˆ·æ‰“å°å·¥ç¨‹å›¾è§£æ–‡æ¡£.</p><h2 id=æ–‡æ¡£æ˜¯é’ˆå¯¹ç”¨æˆ·çš„-documentation-is-for-users>æ–‡æ¡£æ˜¯é’ˆå¯¹ç”¨æˆ·çš„ (<a href="https://www.bilibili.com/video/av18889438/?t=19m07s">Documentation is for users</a>)</h2><p>å¾ˆå¤šäººå†™æ–‡æ¡£è¡¨æ˜æŸä¸ª func æ˜¯åšä»€ä¹ˆçš„, ä½†æ˜¯ä»–ä»¬ä¸æƒ³æƒ³è¿™ä¸ª func æ˜¯ä¸ºè°è€Œå†™. è¿™æœ‰å¾ˆå¤§çš„ä¸åŒ. ä½ çŸ¥é“è¿™ä¸ª func è¿”å›ä»€ä¹ˆæ˜¯å¯¹çš„, ä½†æ˜¯å®ƒä¸ºä»€ä¹ˆè¿”å›äº†ä½ ä½¿ç”¨çš„æ—¶å€™ä¸ä¸€æ ·çš„ç»“æœ?</p><p>æŠŠè‡ªå·±å½“æˆä½¿ç”¨è€…è€Œä¸æ˜¯å†™å®ƒçš„äºº, é‚£ä¹ˆ godoc ä¸Šçš„æ–‡æ¡£å°±æ˜¯å¯¹ç”¨æˆ·æœ‰ç”¨çš„. è¿™å¯¹äºå…¶ä»–è¯­è¨€ä¸€æ ·é€‚ç”¨.</p><h2 id=ä¸è¦æ…Œ-don>ä¸è¦æ…Œ (<a href=https://github.com/golang/go/wiki/CodeReviewComments#dont-panic>Don&rsquo;t panic</a>)</h2><p>ä¸è¦ä½¿ç”¨ panic è¿›è¡Œæ­£å¸¸çš„é”™è¯¯å¤„ç†. ä½¿ç”¨é”™è¯¯ (error) å’Œå¤šä¸ªè¿”å›å€¼.</p></div><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//douglarek.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a><footer class=content__footer></footer></section><section class=page__aside><div class=aside__content><p>2018-01-28</p><hr>On this page:<nav id=TableOfContents><ul><li><a href=#ä¸è¦é€šè¿‡å…±äº«å†…å­˜è¿›è¡Œé€šä¿¡-é€šè¿‡é€šä¿¡å…±äº«å†…å­˜-don>ä¸è¦é€šè¿‡å…±äº«å†…å­˜è¿›è¡Œé€šä¿¡, é€šè¿‡é€šä¿¡å…±äº«å†…å­˜ (<a href="https://www.bilibili.com/video/av18889438/?t=2m48s">Don&rsquo;t communicate by sharing memory, share memory by communicating</a>)</a></li><li><a href=#å¹¶å‘ä¸æ˜¯å¹¶è¡Œ-concurrency-is-not-parallelism>å¹¶å‘ä¸æ˜¯å¹¶è¡Œ (<a href="https://www.bilibili.com/video/av18889438/?t=3m42s">Concurrency is not parallelism</a>)</a></li><li><a href=#channels-é‡æ’åº-äº’æ–¥é‡ä¸²è¡ŒåŒ–-channels-orchestrate-mutexes-serialize>Channels é‡æ’åº; äº’æ–¥é‡ä¸²è¡ŒåŒ– (<a href="https://www.bilibili.com/video/av18889438/?t=4m20s">Channels orchestrate; mutexes serialize</a>)</a></li><li><a href=#æ¥å£è¶Šå¤§-æŠ½è±¡è¶Šå¼±-the-bigger-the-interface-the-weaker-the-abstraction>æ¥å£è¶Šå¤§, æŠ½è±¡è¶Šå¼± (<a href="https://www.bilibili.com/video/av18889438/?t=5m17s">The bigger the interface, the weaker the abstraction</a>)</a></li><li><a href=#å……åˆ†åˆ©ç”¨é›¶å€¼-make-the-zero-value-useful>å……åˆ†åˆ©ç”¨é›¶å€¼ (<a href="https://www.bilibili.com/video/av18889438/?t=6m25s">Make the zero value useful</a>)</a></li><li><a href=#interface-è¨€ä¹‹æ— ç‰©-interface-says-nothing>interface{} è¨€ä¹‹æ— ç‰© (<a href="https://www.bilibili.com/video/av18889438/?t=7m36s">interface{} says nothing</a>)</a></li><li><a href=#gofmt-çš„é£æ ¼æ²¡æœ‰äººå–œæ¬¢-ä½†æ˜¯-gofmt-æ˜¯æ¯ä¸ªäººçš„æœ€çˆ±-gofmt>Gofmt çš„é£æ ¼æ²¡æœ‰äººå–œæ¬¢, ä½†æ˜¯ gofmt æ˜¯æ¯ä¸ªäººçš„æœ€çˆ± (<a href="https://www.bilibili.com/video/av18889438/?t=8m43s">Gofmt&rsquo;s style is no one&rsquo;s favorite, yet gofmt is everyone&rsquo;s favorite</a>)</a></li><li><a href=#å°å¤åˆ¶å¥½è¿‡å°ä¾èµ–-a-little-copying-is-better-than-a-little-dependency>å°å¤åˆ¶å¥½è¿‡å°ä¾èµ– (<a href="https://www.bilibili.com/video/av18889438/?t=9m28s">A little copying is better than a little dependency</a>)</a></li><li><a href=#ç³»ç»Ÿè°ƒç”¨å¿…é¡»å§‹ç»ˆä½¿ç”¨æ„å»ºæ ‡ç­¾ä¿è¯-syscall-must-always-be-guarded-with-build-tags>ç³»ç»Ÿè°ƒç”¨å¿…é¡»å§‹ç»ˆä½¿ç”¨æ„å»ºæ ‡ç­¾ä¿è¯ (<a href="https://www.bilibili.com/video/av18889438/?t=11m10s">Syscall must always be guarded with build tags</a>)</a></li><li><a href=#cgo-å¿…é¡»å§‹ç»ˆä½¿ç”¨æ„å»ºæ ‡ç­¾ä¿è¯-cgo-must-always-be-guarded-with-build-tags>Cgo å¿…é¡»å§‹ç»ˆä½¿ç”¨æ„å»ºæ ‡ç­¾ä¿è¯ (<a href="https://www.bilibili.com/video/av18889438/?t=11m53s">Cgo must always be guarded with build tags</a>)</a></li><li><a href=#cgo-ä¸æ˜¯-go-cgo-is-not-go>Cgo ä¸æ˜¯ Go (<a href="https://www.bilibili.com/video/av18889438/?t=12m37s">Cgo is not Go</a>)</a></li><li><a href=#unsafe-åŒ…æ— ä¿è¯-with-the-unsafe-package-there-are-no-guarantees>unsafe åŒ…æ— ä¿è¯ (With the unsafe package there are no guarantees)</a></li><li><a href=#æ¸…æ™°å¥½è¿‡èªæ˜-clear-is-better-than-clever>æ¸…æ™°å¥½è¿‡èªæ˜ (<a href="https://www.bilibili.com/video/av18889438/?t=14m35s">Clear is better than clever</a>)</a></li><li><a href=#åå°„æ°¸è¿œä¸æ˜¯æ¸…æ™°çš„-reflection-is-never-clear>åå°„æ°¸è¿œä¸æ˜¯æ¸…æ™°çš„ (<a href="https://www.bilibili.com/video/av18889438/?t=15m22s">Reflection is never clear</a>)</a></li><li><a href=#é”™è¯¯ä¹Ÿæ˜¯ä¸€ç§å€¼-errors-are-values>é”™è¯¯ä¹Ÿæ˜¯ä¸€ç§å€¼ (<a href="https://www.bilibili.com/video/av18889438/?t=16m13s">Errors are values</a>)</a></li><li><a href=#ä¸è¦æ­¢æ­¥äºæ£€æŸ¥é”™è¯¯è€Œè¦ä¼˜é›…çš„å¤„ç†-don>ä¸è¦æ­¢æ­¥äºæ£€æŸ¥é”™è¯¯è€Œè¦ä¼˜é›…çš„å¤„ç† (<a href="https://www.bilibili.com/video/av18889438/?t=17m25s">Don&rsquo;t just check errors, handle them gracefully</a>)</a></li><li><a href=#è®¾è®¡æ¶æ„-å‘½åç»„ä»¶-è®°å½•ç»†èŠ‚-design-the-architecture-name-the-components-document-the-details>è®¾è®¡æ¶æ„, å‘½åç»„ä»¶, è®°å½•ç»†èŠ‚ (<a href="https://www.bilibili.com/video/av18889438/?t=18m09s">Design the architecture, name the components, document the details</a>)</a></li><li><a href=#æ–‡æ¡£æ˜¯é’ˆå¯¹ç”¨æˆ·çš„-documentation-is-for-users>æ–‡æ¡£æ˜¯é’ˆå¯¹ç”¨æˆ·çš„ (<a href="https://www.bilibili.com/video/av18889438/?t=19m07s">Documentation is for users</a>)</a></li><li><a href=#ä¸è¦æ…Œ-don>ä¸è¦æ…Œ (<a href=https://github.com/golang/go/wiki/CodeReviewComments#dont-panic>Don&rsquo;t panic</a>)</a></li></ul></nav></div></section><footer class=page__footer><p></p><br><br><p class=copyright>Copyright Â© 2025 Leo Douglas</p></footer></div></body></html>