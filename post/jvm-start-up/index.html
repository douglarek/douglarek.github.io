<!doctype html><html lang=zh><head><title>æ·±å…¥è§£æ JVM å¯åŠ¨è¿‡ç¨‹ &ndash; Code talks</title><meta name=viewport content="width=device-width,initial-scale=1"><meta charset=UTF-8><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.4/css/academicons.min.css integrity="sha512-IW0nhlW5MgNydsXJO40En2EoCkTTjZhI3yuODrZIc8cQ4h1XcF53PsqDHa09NqnkXuIe0Oiyyj171BqZFwISBw==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=/css/palettes/base16-dark.css><link rel=stylesheet href=/css/risotto.css><link rel=stylesheet href=/css/custom.css><link rel=icon href=/favicon.ico><meta property="og:title" content="æ·±å…¥è§£æ JVM å¯åŠ¨è¿‡ç¨‹ &ndash; Code talks"><meta property="og:url" content="/post/jvm-start-up/"><meta property="og:locale" content="zh-CN"><script async src="https://www.googletagmanager.com/gtag/js?id=G-4TVXFV2XZM%20"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-4TVXFV2XZM ")}</script></head><body><div class=page><header class=page__header><nav class="page__nav main-nav"><ul><li class=nomarker><h1 class=page__logo><a href=/ class=page__logo-inner>Code talks</a></h1></li><li class=main-nav__item><a class=nav-main-item href=/post title>Posts</a></li><li class=main-nav__item><a class=nav-main-item href=/tags title>Tags</a></li><li class=main-nav__item><a class=nav-main-item href=https://github.com/douglarek title>GitHub</a></li></ul></nav></header><section class=page__body><header class=content__header><h1>æ·±å…¥è§£æ JVM å¯åŠ¨è¿‡ç¨‹</h1><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6649330439620894" crossorigin=anonymous></script></header><div class=content__body><p>æœ¬æ–‡ç¿»è¯‘è‡ª <a href=https://inside.java/2025/01/28/jvm-start-up/>A Deep Dive into JVM Start-up</a>ï¼Œç‰ˆæƒå½’åŸä½œè€…æ‰€æœ‰ã€‚</p><p>å½“ä½ å¯åŠ¨ä¸€ä¸ª Java åº”ç”¨ç¨‹åºæ—¶ï¼Œä½ å¯èƒ½ä¼šè®¤ä¸ºå”¯ä¸€æ‰§è¡Œçš„ä»£ç å°±æ˜¯ä¼ é€’ç»™ JVM çš„ Java å­—èŠ‚ç ï¼Œå³ç”± <code>javac</code> ç¼–è¯‘ç”Ÿæˆçš„ <code>.class</code> æ–‡ä»¶ã€‚ä½†å®é™…ä¸Šï¼Œåœ¨å¯åŠ¨è¿‡ç¨‹ä¸­ï¼ŒJVM ä¼šç»å†ä¸€ç³»åˆ—å¤æ‚çš„æ­¥éª¤ï¼Œä¸ºè¿è¡Œ Java åº”ç”¨ç¨‹åºåˆ›å»ºä¸€ä¸ªå®Œæ•´çš„è¿è¡Œç¯å¢ƒã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†è¯¦ç»†ä»‹ç» JVM ä»æ‰§è¡Œ <code>$ java</code> åˆ°æ‰“å° <code>Hello World</code> æ‰€ç»å†çš„æ­¥éª¤ã€‚å¦‚æœä½ æ›´å–œæ¬¢è§†é¢‘å½¢å¼ï¼Œä¹Ÿå¯ä»¥åœ¨ Java YouTube é¢‘é“è§‚çœ‹è¿™ä¸ªè§†é¢‘ï¼š</p><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share; fullscreen" loading=eager referrerpolicy=strict-origin-when-cross-origin src="https://www.youtube-nocookie.com/embed/ED1oc7gn5uY?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 title="YouTube video"></iframe></div><h2 id=å‰è¨€>å‰è¨€</h2><p>ä¸ºäº†è®©è¿™æ¬¡å¯¹ JVM å¯åŠ¨è¿‡ç¨‹çš„è®²è§£ä¸è‡³äºè¿‡äºåºå¤§ï¼Œæˆ‘å°†ä½¿ç”¨ä»¥ä¸‹å‡ ä¸ªçº¦æŸæ¡ä»¶æ¥æè¿°è¿™ä¸ªè¿‡ç¨‹ï¼š</p><ul><li>æˆ‘å°†æè¿° JVM å¯åŠ¨è¿‡ç¨‹åœ¨ JDK 23 ä¸­çš„è¡Œä¸ºã€‚ä½ å¯ä»¥åœ¨<a href=https://docs.oracle.com/javase/specs/jvms/se23/html/index.html>è¿™é‡Œ</a>æŸ¥çœ‹ Java SE 23 çš„ JVM è§„èŒƒã€‚</li><li>æˆ‘å°†ä½¿ç”¨ <a href=https://en.wikipedia.org/wiki/HotSpot_(virtual_machine)>HotSpot JVM</a> å®ç°ä½œä¸ºç¤ºä¾‹ã€‚è¿™æ˜¯ç›®å‰ä½¿ç”¨æœ€å¹¿æ³›çš„ JVM å®ç°ï¼Œè®¸å¤šæµè¡Œçš„ JDK å‘è¡Œç‰ˆéƒ½ä½¿ç”¨ HotSpot JVM æˆ–å…¶è¡ç”Ÿç‰ˆæœ¬ã€‚å…¶ä»– JVM å®ç°å¯èƒ½åœ¨å†…éƒ¨è¡Œä¸ºä¸Šç•¥æœ‰ä¸åŒã€‚</li><li>æœ€åï¼Œæˆ‘å°†ä½¿ç”¨çš„ä¸»è¦ä»£ç ç¤ºä¾‹æ˜¯ <code>HelloWorld</code>ï¼Œå°½ç®¡è¿™æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„åº”ç”¨ç¨‹åºï¼Œä½†å®ƒä»ç„¶ä¼šè§¦å‘ JVM å¯åŠ¨è¿‡ç¨‹çš„æ‰€æœ‰å…³é”®ç¯èŠ‚ã€‚</li></ul><p>å°½ç®¡æœ‰è¿™äº›çº¦æŸæ¡ä»¶ï¼Œä½†åœ¨é˜…è¯»å®Œæœ¬æ–‡åï¼Œä½ åº”è¯¥èƒ½å¤Ÿå¯¹ JVM åœ¨å¯åŠ¨è¿‡ç¨‹ä¸­æ‰€ç»å†çš„æµç¨‹ä»¥åŠå®ƒä»¬ä¸ºä½•å¿…è¦æœ‰ä¸€ä¸ªç›¸å½“å…¨é¢çš„ç†è§£ã€‚è¿™äº›çŸ¥è¯†åœ¨è°ƒè¯•åº”ç”¨ç¨‹åºå¯åŠ¨æ—¶é‡åˆ°çš„é—®é¢˜æ—¶ä¼šå¾ˆæœ‰å¸®åŠ©ï¼Œåœ¨æŸäº›ç‰¹å®šæƒ…å†µä¸‹è¿˜èƒ½å¸®åŠ©æ”¹å–„å¯åŠ¨æ€§èƒ½ã€‚ä¸è¿‡ï¼Œæˆ‘ä»¬ä¼šåœ¨æ–‡ç« æœ«å°¾æ›´è¯¦ç»†åœ°è®¨è®ºè¿™ä¸€ç‚¹ã€‚</p><h2 id=jvm-åˆå§‹åŒ–>JVM åˆå§‹åŒ–</h2><p>å½“ç”¨æˆ·æ‰§è¡Œ <code>java</code> å‘½ä»¤æ—¶ï¼Œè¿™ä¼šé€šè¿‡è°ƒç”¨ JNIï¼ˆJava Native Interfaceï¼‰å‡½æ•° <code>JNI_CreateJavaVM()</code> æ¥å¯åŠ¨ JVM å¯åŠ¨è¿‡ç¨‹ï¼Œä½ å¯ä»¥åœ¨<a href=https://github.com/openjdk/jdk/blob/jdk-23%2B0/src/hotspot/share/prims/jni.cpp#L3661C1-L3661C93>è¿™é‡Œ</a>æŸ¥çœ‹è¿™ä¸ªå‡½æ•°çš„ä»£ç ã€‚è¿™ä¸ª JNI å‡½æ•°æœ¬èº«ä¼šæ‰§è¡Œå‡ ä¸ªé‡è¦çš„è¿‡ç¨‹ã€‚</p><h3 id=éªŒè¯ç”¨æˆ·è¾“å…¥>éªŒè¯ç”¨æˆ·è¾“å…¥</h3><p>JVM å¯åŠ¨è¿‡ç¨‹çš„ç¬¬ä¸€æ­¥æ˜¯éªŒè¯ç”¨æˆ·è¾“å…¥ï¼šJVM å‚æ•°ã€è¦æ‰§è¡Œçš„å·¥ä»¶å’Œç±»è·¯å¾„ã€‚ä¸‹é¢çš„æ—¥å¿—è¾“å‡ºæ˜¾ç¤ºäº†è¿™ä¸ªéªŒè¯è¿‡ç¨‹çš„è¿›è¡Œï¼š</p><pre tabindex=0><code>[arguments] VM Arguments:
[arguments] jvm_args: -Xlog:all=trace
[arguments] java_command: HelloWorld
[arguments] java_class_path (initial): .
[arguments] Launcher Type: SUN_STANDARD
</code></pre><p><strong>ğŸ’¡æ³¨æ„ï¼š</strong> ä½ ä¹Ÿå¯ä»¥é€šè¿‡ä½¿ç”¨ JVM å‚æ•° <code>-Xlog:all=trace</code> æ¥æŸ¥çœ‹è¿™äº›æ—¥å¿—ã€‚</p><h3 id=æ£€æµ‹ç³»ç»Ÿèµ„æº>æ£€æµ‹ç³»ç»Ÿèµ„æº</h3><p>éªŒè¯ç”¨æˆ·è¾“å…¥åï¼Œä¸‹ä¸€æ­¥æ˜¯æ£€æµ‹å¯ç”¨çš„ç³»ç»Ÿèµ„æºï¼šå¤„ç†å™¨ã€ç³»ç»Ÿå†…å­˜å’Œ JVM å¯èƒ½ä½¿ç”¨çš„ç³»ç»ŸæœåŠ¡ã€‚å¯ç”¨ç³»ç»Ÿèµ„æºçš„æƒ…å†µå¯èƒ½ä¼šå½±å“ JVM æ ¹æ®å…¶å†…éƒ¨å¯å‘å¼ç®—æ³•åšå‡ºçš„å†³ç­–ã€‚ä¾‹å¦‚ï¼ŒJVM é»˜è®¤é€‰æ‹©çš„åƒåœ¾æ”¶é›†å™¨å°†å–å†³äº CPU å’Œç³»ç»Ÿå†…å­˜çš„å¯ç”¨æ€§ï¼Œä¸è¿‡ JVM çš„è®¸å¤šå†…éƒ¨å¯å‘å¼ç®—æ³•éƒ½å¯ä»¥é€šè¿‡ä½¿ç”¨æ˜ç¡®çš„ JVM å‚æ•°æ¥è¦†ç›–ã€‚</p><pre tabindex=0><code>[os       ] Initial active processor count set to 11
[gc,heap  ]   Maximum heap size 9663676416
[gc,heap  ]   Initial heap size 603979776
[gc,heap  ]   Minimum heap size 1363144
[metaspace]  - commit_granule_bytes: 65536.
[metaspace]  - commit_granule_words: 8192.
[metaspace]  - virtual_space_node_default_size: 8388608.
[metaspace]  - enlarge_chunks_in_place: 1.
[os       ] Use of CLOCK_MONOTONIC is supported
[os       ] Use of pthread_condattr_setclock is not supported
</code></pre><h3 id=å‡†å¤‡ç¯å¢ƒ>å‡†å¤‡ç¯å¢ƒ</h3><p>åœ¨äº†è§£å¯ç”¨çš„ç³»ç»Ÿèµ„æºåï¼ŒJVM å°†å¼€å§‹å‡†å¤‡ç¯å¢ƒã€‚åœ¨è¿™é‡Œï¼ŒHotSpot JVM å®ç°ä¼šç”Ÿæˆ <code>hsprefdata</code>ï¼ˆHotSpot æ€§èƒ½æ•°æ®ï¼‰ã€‚è¿™äº›æ•°æ®è¢« <code>JConsole</code> å’Œ <code>VisualVM</code> ç­‰å·¥å…·ç”¨äºæ£€æŸ¥å’Œåˆ†æ JVMã€‚è¿™äº›æ•°æ®é€šå¸¸å­˜å‚¨åœ¨ç³»ç»Ÿçš„ <code>/tmp</code> ç›®å½•ä¸­ã€‚ä¸‹é¢åªæ˜¯ JVM åˆ›å»ºè¿™äº›æ€§èƒ½æ•°æ®çš„ä¸€ä¸ªä¾‹å­ï¼Œåœ¨å¯åŠ¨è¿‡ç¨‹ä¸­ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¼šæŒç»­ä¸€æ®µæ—¶é—´ï¼Œå¹¶ä¸å…¶ä»–è¿‡ç¨‹å¹¶å‘è¿›è¡Œã€‚</p><pre tabindex=0><code>[perf,datacreation] name = sun.rt._sync_Inflations, dtype = 11, variability = 2, units = 4, dsize = 8, vlen = 0, pad_length = 4, size = 56, on_c_heap = FALSE, address = 0x0000000100c2c020, data address = 0x0000000100c2c050
</code></pre><h3 id=é€‰æ‹©åƒåœ¾æ”¶é›†å™¨>é€‰æ‹©åƒåœ¾æ”¶é›†å™¨</h3><p>JVM å¯åŠ¨è¿‡ç¨‹ä¸­çš„ä¸€ä¸ªé‡è¦æ­¥éª¤æ˜¯é€‰æ‹©åƒåœ¾æ”¶é›†å™¨ï¼ˆGCï¼‰ã€‚ä½¿ç”¨å“ªä¸ª GC å¯èƒ½ä¼šå¯¹åº”ç”¨ç¨‹åºçš„æ€§èƒ½äº§ç”Ÿé‡å¤§å½±å“ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒJVM ä¼šä»ä¸¤ä¸ª GC ä¸­è¿›è¡Œé€‰æ‹©ï¼šSerial GC å’Œ G1 GCï¼Œé™¤éå¦æœ‰æŒ‡ç¤ºã€‚</p><p>ä» JDK 23 å¼€å§‹ï¼ŒJVM é»˜è®¤ä¼šé€‰æ‹© G1 GCï¼Œé™¤éç³»ç»Ÿå¯ç”¨å†…å­˜å°‘äº 1792 MBï¼Œå’Œ/æˆ–åªæœ‰å•ä¸ªå¤„ç†å™¨ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ä¼šé€‰æ‹© Serial GCã€‚å½“ç„¶ï¼Œè¿˜å¯èƒ½æœ‰å…¶ä»– GC å¯ç”¨ï¼ŒåŒ…æ‹¬ï¼šParallel GCã€ZGC ç­‰ï¼Œè¿™å–å†³äºä½ ä½¿ç”¨çš„ç‰¹å®š JDK ç‰ˆæœ¬å’Œå‘è¡Œç‰ˆï¼Œæ¯ä¸ª GC éƒ½æœ‰å…¶ç‹¬ç‰¹çš„æ€§èƒ½ç‰¹å¾å’Œç†æƒ³çš„å·¥ä½œè´Ÿè½½ã€‚</p><pre tabindex=0><code>[gc           ] Using G1
[gc,heap,coops] Trying to allocate at address 0x00000005c0000000 heap of size 0x240000000
[os,map       ] Reserved [0x00000005c0000000 - 0x0000000800000000), (9663676416 bytes)
[gc,heap,coops] Heap address: 0x00000005c0000000, size: 9216 MB, Compressed Oops mode: Zero based, Oop shift amount: 3
</code></pre><h3 id=cds>CDS</h3><p>å¤§çº¦åœ¨è¿™ä¸ªæ—¶å€™ï¼ŒJVM ä¼šæŸ¥æ‰¾ CDS å½’æ¡£ã€‚CDSï¼ˆCached Data Storageï¼Œä»¥å‰ç§°ä¸º Class Data Storageï¼‰æ˜¯ä¸€ä¸ªç»è¿‡é¢„å¤„ç†çš„ç±»æ–‡ä»¶å½’æ¡£ï¼Œå¯ä»¥æé«˜ JVM çš„å¯åŠ¨æ€§èƒ½ã€‚æˆ‘ä»¬å°†åœ¨<a href=#%E7%B1%BB%E9%93%BE%E6%8E%A5>ç±»é“¾æ¥</a>éƒ¨åˆ†ä»‹ç» CDS å¦‚ä½•æé«˜ JVM å¯åŠ¨æ€§èƒ½ã€‚ä¸è¿‡ï¼Œä¸è¦æŠŠ"CDS"è®°å¾—å¤ªç‰¢ï¼Œå®ƒå³å°†è¢«æ·˜æ±°ï¼Œæˆ‘ä»¬ç¨ååœ¨å±•æœ› JVM å¯åŠ¨çš„æœªæ¥æ—¶ä¼šä»‹ç»åŸå› ã€‚</p><pre tabindex=0><code>[cds] trying to map [Java home]/lib/server/classes.jsa
[cds] Opened archive [Java home]/lib/server/classes.jsa.
</code></pre><h3 id=åˆ›å»ºæ–¹æ³•åŒº>åˆ›å»ºæ–¹æ³•åŒº</h3><p>JVM åˆå§‹åŒ–çš„æœ€åä¸€ä¸ªæ­¥éª¤æ˜¯åˆ›å»ºæ–¹æ³•åŒºã€‚è¿™æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å †å¤–å†…å­˜ä½ç½®ï¼Œç”¨äºå­˜å‚¨ JVM åŠ è½½çš„ç±»æ•°æ®ã€‚è™½ç„¶æ–¹æ³•åŒºä¸ä½äº JVM çš„å †ä¸­ï¼Œä½†åƒåœ¾æ”¶é›†å™¨ä»ç„¶ä¼šç®¡ç†å®ƒã€‚å¦‚æœä¸ç±»ç›¸å…³è”çš„ç±»åŠ è½½å™¨ä¸å†åœ¨ä½œç”¨åŸŸå†…ï¼Œåˆ™å­˜å‚¨åœ¨æ–¹æ³•åŒºä¸­çš„ç±»æ•°æ®æœ‰èµ„æ ¼è¢«ç§»é™¤ã€‚</p><p><strong>ğŸ’¡ æ³¨æ„ï¼š</strong> å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ HotSpot JVM å®ç°ï¼Œæ–¹æ³•åŒºè¢«ç§°ä¸º <em>metaspace</em>ã€‚</p><pre tabindex=0><code>[metaspace,map] Trying to reserve at an EOR-compatible address
[metaspace,map] Mapped at 0x00001fff00000000
</code></pre><h2 id=ç±»åŠ è½½é“¾æ¥å’Œåˆå§‹åŒ–>ç±»åŠ è½½ã€é“¾æ¥å’Œåˆå§‹åŒ–</h2><p>ä¸€æ—¦å®Œæˆäº†æœ€åˆçš„å‡†å¤‡å·¥ä½œï¼ŒJVM å¯åŠ¨è¿‡ç¨‹çš„çœŸæ­£"æ ¸å¿ƒ"éƒ¨åˆ†å°±å¼€å§‹äº†ï¼Œè¿™æ¶‰åŠåˆ°ç±»åŠ è½½ã€é“¾æ¥å’Œåˆå§‹åŒ–ã€‚</p><p>è™½ç„¶ <a href=https://docs.oracle.com/javase/specs/jvms/se23/html/index.html>JVM è§„èŒƒ</a>æŒ‰é¡ºåºæè¿°äº†è¿™äº›è¿‡ç¨‹ï¼ˆç¬¬ 5.3-5.5 èŠ‚ï¼‰ï¼Œä½†å¯¹äºç»™å®šçš„ç±»ï¼Œè¿™äº›è¿‡ç¨‹åœ¨ HotSpot JVM ä¸Šä¸ä¸€å®šæŒ‰ç…§è¯¥é¡ºåºå‘ç”Ÿã€‚å¦‚å›¾è¡¨åº•éƒ¨æ‰€ç¤ºï¼Œä½œä¸ºç±»é“¾æ¥ä¸€éƒ¨åˆ†çš„è§£æï¼Œå¯èƒ½åœ¨ä»éªŒè¯ä¹‹å‰åˆ°ç±»åˆå§‹åŒ–ä¹‹åçš„ä»»ä½•æ—¶é—´ç‚¹å‘ç”Ÿã€‚æŸäº›è¿‡ç¨‹ï¼Œå¦‚ç±»åˆå§‹åŒ–ï¼Œåœ¨æŠ€æœ¯ä¸Šå¯èƒ½æ ¹æœ¬ä¸ä¼šå‘ç”Ÿã€‚æˆ‘ä»¬å°†åœ¨æ¥ä¸‹æ¥çš„ç« èŠ‚ä¸­ä»‹ç»æ‰€æœ‰è¿™äº›å†…å®¹ã€‚</p><p><img src=/images/jvm-class-load-link-init-chart.png alt=ç±»åŠ è½½ã€é“¾æ¥å’Œåˆå§‹åŒ–æµç¨‹å›¾></p><h3 id=ç±»åŠ è½½>ç±»åŠ è½½</h3><p>ç±»åŠ è½½åœ¨ <a href=https://docs.oracle.com/javase/specs/jvms/se23/html/jvms-5.html#jvms-5.3>JVM è§„èŒƒç¬¬ 5.3 èŠ‚</a>ä¸­æœ‰è¯¦ç»†è¯´æ˜ã€‚ç±»åŠ è½½æ˜¯ä¸€ä¸ªä¸‰æ­¥è¿‡ç¨‹ï¼šJVM å®šä½ç±»æˆ–æ¥å£çš„äºŒè¿›åˆ¶è¡¨ç¤ºï¼Œä»ä¸­æ´¾ç”Ÿç±»æˆ–æ¥å£ï¼Œå¹¶å°†è¯¥ä¿¡æ¯åŠ è½½åˆ° JVM æ–¹æ³•åŒºâ€”â€”å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ HotSpot JVM å®ç°ï¼Œè¿™ä¸ªåŒºåŸŸå°±æ˜¯"metaspace"ã€‚</p><p>JVM æœ€å¼ºå¤§çš„èƒ½åŠ›ä¹‹ä¸€ï¼Œä¹Ÿæ˜¯å®ƒæˆä¸ºå¹¿æ³›ä½¿ç”¨å¹³å°çš„åŸå› ä¹‹ä¸€ï¼Œæ˜¯å®ƒèƒ½å¤Ÿ<em>åŠ¨æ€</em>åŠ è½½ç±»ï¼Œå…è®¸ JVM åœ¨è¿è¡Œæ—¶æŒ‰éœ€åŠ è½½ç”Ÿæˆçš„ç±»ã€‚è¿™ç§èƒ½åŠ›è¢«è®¸å¤šæµè¡Œçš„æ¡†æ¶å’Œå·¥å…·ä½¿ç”¨ï¼Œä¾‹å¦‚ Spring å’Œ Mockitoã€‚å®é™…ä¸Šï¼Œå³ä½¿æ˜¯ JVM æœ¬èº«åœ¨ä½¿ç”¨ lambda è¡¨è¾¾å¼æ—¶ä¹Ÿä¼šæ‰§è¡ŒæŒ‰éœ€ä»£ç ç”Ÿæˆï¼Œæ­£å¦‚ <a href=https://github.com/openjdk/jdk/blob/master/src/java.base/share/classes/java/lang/invoke/InnerClassLambdaMetafactory.java>InnerClassLambdaMetafactory ç±»</a>ä¸­æ‰€ç¤ºã€‚</p><p>JVM å…è®¸ä¸¤ç§æ–¹å¼åŠ è½½ç±»ï¼Œä¸€ç§æ˜¯ä½¿ç”¨å¼•å¯¼ç±»åŠ è½½å™¨ï¼ˆ<a href=https://docs.oracle.com/javase/specs/jvms/se23/html/jvms-5.html#jvms-5.3.1>5.3.1</a>ï¼‰ï¼Œå¦ä¸€ç§æ˜¯è‡ªå®šä¹‰ç±»åŠ è½½å™¨ï¼ˆ<a href=https://docs.oracle.com/javase/specs/jvms/se23/html/jvms-5.html#jvms-5.3.2>5.3.2</a>ï¼‰ã€‚åè€…æ˜¯ä¸€ä¸ªæ‰©å±•äº† <a href=https://github.com/openjdk/jdk/blob/jdk-23%2B0/src/java.base/share/classes/java/lang/ClassLoader.java>java.lang.ClassLoader</a> ç±»çš„ç±»ã€‚å®é™…ä¸Šï¼Œè‡ªå®šä¹‰ç±»åŠ è½½å™¨é€šå¸¸ä¼šåœ¨ç¬¬ä¸‰æ–¹åº“ä¸­å®šä¹‰ï¼Œä»¥æ”¯æŒè¯¥åº“çš„è¡Œä¸ºã€‚</p><p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†åªå…³æ³¨å¼•å¯¼ç±»åŠ è½½å™¨ï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨æœºå™¨ç ç¼–å†™çš„ç‰¹æ®Šç±»åŠ è½½å™¨ï¼Œç”± JVM æä¾›ã€‚å®ƒåœ¨ <code>JNI_CreateJavaVM()</code> çš„åæœŸé˜¶æ®µå®ä¾‹åŒ–ã€‚</p><p>ä¸ºäº†æ›´å¥½åœ°ç†è§£ç±»åŠ è½½è¿‡ç¨‹ï¼Œæˆ‘ä»¬éœ€è¦çœ‹çœ‹ JVM å¦‚ä½•çœ‹å¾… <code>HelloWorld</code>ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>HelloWorld</span> <span style=color:#66d9ef>extends</span> Object {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span>(String<span style=color:#f92672>[]</span> args){
</span></span><span style=display:flex><span>		System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;Hello World!&#34;</span>);
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>æ‰€æœ‰ç±»åœ¨æŸä¸ªæ—¶åˆ»éƒ½ä¼šæ‰©å±•è‡ª <code>java.lang.Object</code>ã€‚ä¸ºäº†è®© JVM åŠ è½½ <code>HelloWorld</code>ï¼Œå®ƒé¦–å…ˆéœ€è¦åŠ è½½ <code>HelloWorld</code> æ˜¾å¼å’Œéšå¼ä¾èµ–çš„æ‰€æœ‰ç±»ã€‚è®©æˆ‘ä»¬çœ‹çœ‹ <code>java.lang.Object</code> ä¸­çš„æ‰€æœ‰æ–¹æ³•ç­¾åï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Object</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>Object</span>() {}
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>native</span> Class<span style=color:#f92672>&lt;?&gt;</span> getClass()
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>native</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>hashCode</span>()
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>boolean</span> <span style=color:#a6e22e>equals</span>(Object obj)
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>protected</span> <span style=color:#66d9ef>native</span> Object <span style=color:#a6e22e>clone</span>() <span style=color:#66d9ef>throws</span> CloneNotSupportedException
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>public</span> String <span style=color:#a6e22e>toString</span>()
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>native</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>notify</span>();
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>native</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>notifyAll</span>();
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>wait</span>() <span style=color:#66d9ef>throws</span> InterruptedException
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>wait</span>(<span style=color:#66d9ef>long</span> timeoutMillis) <span style=color:#66d9ef>throws</span> InterruptedException
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>wait</span>(<span style=color:#66d9ef>long</span> timeoutMillis, <span style=color:#66d9ef>int</span> nanos) <span style=color:#66d9ef>throws</span> InterruptedException
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>protected</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>finalize</span>() <span style=color:#66d9ef>throws</span> Throwable { }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>ä¸¤ä¸ªé‡è¦çš„æ–¹æ³•æ˜¯ <code>public final native Class&lt;?> getClass()</code> å’Œ <code>public String toString()</code>ï¼Œå› ä¸ºè¿™ä¸¤ä¸ªæ–¹æ³•éƒ½å¼•ç”¨äº†å¦ä¸€ä¸ªç±»ï¼šåˆ†åˆ«æ˜¯ <code>java.lang.Class</code> å’Œ <code>java.lang.String</code>ã€‚</p><p>å¦‚æœæˆ‘ä»¬çœ‹çœ‹ <code>java.lang.String</code>ï¼Œå®ƒå®ç°äº†å‡ ä¸ªæ¥å£ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>String</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>implements</span> java.<span style=color:#a6e22e>io</span>.<span style=color:#a6e22e>Serializable</span>, Comparable<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>&gt;</span>, CharSequence,
</span></span><span style=display:flex><span>Constable, ConstantDesc
</span></span></code></pre></div><p>ä¸ºäº†åŠ è½½ <code>java.lang.String</code>ï¼Œå¿…é¡»é¦–å…ˆåŠ è½½å®ƒå®ç°çš„æ‰€æœ‰æ¥å£ã€‚å¦‚æœæˆ‘ä»¬æŸ¥çœ‹æ—¥å¿—è¾“å‡ºï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°è¿™äº›ç±»æŒ‰ç…§å®ƒä»¬å®šä¹‰çš„é¡ºåºè¢«åŠ è½½ï¼Œ<code>java.lang.String</code> æœ€åè¢«åŠ è½½ï¼š</p><pre tabindex=0><code>[class,load] java.io.Serializable source: jrt:/java.base
[class,load] java.lang.Comparable source: jrt:/java.base
[class,load] java.lang.CharSequence source: jrt:/java.base
[class,load] java.lang.constant.Constable source: jrt:/java.base
[class,load] java.lang.constant.ConstantDesc source: jrt:/java.base
[class,load] java.lang.String source: jrt:/java.base
</code></pre><p>å¦‚æœæˆ‘ä»¬è½¬åˆ° <code>java.lang.Class</code>ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°å®ƒä¹Ÿå®ç°äº†å‡ ä¸ªæ¥å£ï¼Œä»¥åŠä¸ <code>java.lang.String</code> ç›¸åŒçš„ä¸€äº›æ¥å£ï¼š<code>java.io.Serializable</code> å’Œ <code>java.lang.constant.Constable</code>ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Class</span><span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>implements</span> java.<span style=color:#a6e22e>io</span>.<span style=color:#a6e22e>Serializable</span>,GenericDeclaration,Type,AnnotatedElement,
</span></span><span style=display:flex><span>TypeDescriptor.<span style=color:#a6e22e>OfField</span><span style=color:#f92672>&lt;</span>Class<span style=color:#f92672>&lt;?&gt;&gt;</span>,Constable
</span></span></code></pre></div><p>å¦‚æœæˆ‘ä»¬æŸ¥çœ‹ JVM æ—¥å¿—ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°æ¥å£å†æ¬¡æŒ‰ç…§å®ƒä»¬å®šä¹‰çš„é¡ºåºè¢«åŠ è½½ï¼Œç„¶åæ‰åŠ è½½ <code>java.lang.Class</code>ï¼Œä½† <code>java.io.Serializable</code> å’Œ <code>java.lang.constant.Constable</code> é™¤å¤–ï¼Œå› ä¸ºå®ƒä»¬åœ¨åŠ è½½ <code>java.lang.String</code> æ—¶å·²ç»è¢«åŠ è½½äº†ã€‚</p><pre tabindex=0><code>[class,load] java.lang.reflect.AnnotatedElement source: jrt:/java.base
[class,load] java.lang.reflect.GenericDeclaration source: jrt:/java.base
[class,load] java.lang.reflect.Type source: jrt:/java.base
[class,load] java.lang.invoke.TypeDescriptor source: jrt:/java.base
[class,load] java.lang.invoke.TypeDescriptor$OfField source: jrt:/java.base
[class,load] java.lang.Class source: jrt:/java.base
</code></pre><p><strong>ğŸ’¡ æ³¨æ„ï¼š</strong> ä¸€èˆ¬æ¥è¯´ï¼ŒJVM å¯¹å…¶è¿‡ç¨‹é‡‡ç”¨æƒ°æ€§ç­–ç•¥ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹æ˜¯ç±»åŠ è½½ã€‚ä¸€ä¸ªç±»é€šå¸¸åªåœ¨å¦ä¸€ä¸ªç±»ä¸»åŠ¨å¼•ç”¨å®ƒæ—¶æ‰è¢«åŠ è½½ï¼Œä½†ç”±äº <code>java.lang.Object</code> æ˜¯æ‰€æœ‰ Java ç±»çš„ç‰¹æ®Šæ ¹ç±»ï¼ŒJVM ä¼šæ€¥åˆ‡åœ°åŠ è½½ <code>java.lang.Class</code> å’Œ <code>java.lang.String</code>ã€‚å¦‚æœä½ æŸ¥çœ‹ <code>java.lang.Class</code>ï¼ˆ<a href=https://docs.oracle.com/en/java/javase/23/docs/api/java.base/java/lang/Class.html>JavaDoc</a>ï¼‰å’Œ <code>java.lang.String</code>ï¼ˆ<a href=https://docs.oracle.com/en/java/javase/23/docs/api/java.base/java/lang/String.html>JavaDoc</a>ï¼‰çš„æ–¹æ³•ç­¾åï¼Œä½ å¯èƒ½ä¼šæ³¨æ„åˆ°åœ¨æ‰§è¡Œåƒ <code>HelloWorld</code> è¿™æ ·çš„åº”ç”¨ç¨‹åºæ—¶ï¼Œè®¸å¤šç±»å¹¶æ²¡æœ‰è¢«åŠ è½½ã€‚ä¾‹å¦‚ <code>Optional&lt;String> describeConstable()</code> ä»æœªè¢«å¼•ç”¨ï¼Œå› æ­¤ <code>java.util.Optional</code> ä»ä¸è¢«åŠ è½½ã€‚è¿™æ˜¯ HotSpot æƒ°æ€§ç­–ç•¥çš„ä¸€ä¸ªä¾‹å­ï¼Œæˆ–è€…è¯´æ˜¯ä¸é‡‡å–è¡ŒåŠ¨çš„ä¾‹å­ã€‚</p><p>ç±»åŠ è½½è¿‡ç¨‹å°†è´¯ç©¿ JVM å¯åŠ¨çš„å¤§éƒ¨åˆ†æ—¶é—´ï¼Œåœ¨å®é™…åº”ç”¨ç¨‹åºä¸­ï¼Œè¿˜ä¼šè´¯ç©¿è¯¥åº”ç”¨ç¨‹åºç”Ÿå‘½å‘¨æœŸçš„æ—©æœŸå¾ˆå¤§ä¸€éƒ¨åˆ†æ—¶é—´ï¼Œç„¶åæœ€ç»ˆè¶‹äºç¨³å®šã€‚åœ¨ <code>HelloWorld</code> åœºæ™¯ä¸­ï¼ŒJVM æ€»å…±ä¼šåŠ è½½å¤§çº¦ 450 ä¸ªç±»ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ç”¨ JVM åœ¨å¯åŠ¨æ—¶åˆ›å»ºä¸€ä¸ªå®‡å®™çš„ç±»æ¯”ï¼Œå› ä¸ºå®ƒåšäº†å¾ˆå¤šå·¥ä½œã€‚</p><p>è®©æˆ‘ä»¬ç»§ç»­æ·±å…¥äº†è§£ JVM å¯åŠ¨çš„å®‡å®™ï¼Œçœ‹çœ‹ç±»é“¾æ¥ã€‚</p><h3 id=ç±»é“¾æ¥>ç±»é“¾æ¥</h3><p>ç±»é“¾æ¥åœ¨ <a href=https://docs.oracle.com/javase/specs/jvms/se23/html/jvms-5.html#jvms-5.4>JVM è§„èŒƒç¬¬ 5.4 èŠ‚</a>ä¸­æœ‰è¯¦ç»†è¯´æ˜ï¼Œæ˜¯ä¸€ä¸ªæ›´å¤æ‚çš„è¿‡ç¨‹ï¼Œå› ä¸ºå®ƒåŒ…æ‹¬ä¸‰ä¸ªä¸åŒçš„å­è¿‡ç¨‹ï¼š</p><ul><li>éªŒè¯ - <a href=https://docs.oracle.com/javase/specs/jvms/se23/html/jvms-5.html#jvms-5.4.1>5.4.1</a></li><li>å‡†å¤‡ - <a href=https://docs.oracle.com/javase/specs/jvms/se23/html/jvms-5.html#jvms-5.4.2>5.4.2</a></li><li>è§£æ - <a href=https://docs.oracle.com/javase/specs/jvms/se23/html/jvms-5.html#jvms-5.4.3>5.4.3</a></li></ul><p>ç±»é“¾æ¥ä¸­è¿˜æœ‰å…¶ä»–ä¸‰ä¸ªè¿‡ç¨‹ï¼šè®¿é—®æ§åˆ¶ã€æ–¹æ³•é‡å†™å’Œæ–¹æ³•é€‰æ‹©ï¼Œä½†è¿™äº›è¶…å‡ºäº†æœ¬æ–‡çš„èŒƒå›´ã€‚</p><p><img src=/images/jvm-class-linking-chart.png alt=ç±»é“¾æ¥æµç¨‹å›¾></p><p>å›åˆ°å›¾è¡¨ï¼ŒéªŒè¯ã€å‡†å¤‡å’Œè§£æä¸ä¸€å®šæŒ‰ç…§æœ¬æ–‡ä¸­å°†è¦ä»‹ç»çš„é¡ºåºå‘ç”Ÿã€‚è§£æå¯èƒ½æ—©åœ¨éªŒè¯ä¹‹å‰å‘ç”Ÿï¼Œä¹Ÿå¯èƒ½æ™šè‡³ç±»åˆå§‹åŒ–ä¹‹åå‘ç”Ÿã€‚</p><h4 id=éªŒè¯>éªŒè¯</h4><p>éªŒè¯ï¼ˆ<a href=https://docs.oracle.com/javase/specs/jvms/se23/html/jvms-5.html#jvms-5.4.1>5.4.1</a>ï¼‰æ˜¯ä¸€ä¸ªç¡®ä¿ç±»æˆ–æ¥å£åœ¨ç»“æ„ä¸Šæ­£ç¡®çš„è¿‡ç¨‹ã€‚å¦‚æœéœ€è¦ï¼Œæ­¤è¿‡ç¨‹å¯èƒ½ä¼šè§¦å‘åŠ è½½å…¶ä»–ç±»ï¼Œå°½ç®¡ä½œä¸ºç»“æœåŠ è½½çš„ç±»æœ¬èº«ä¸éœ€è¦è¢«éªŒè¯æˆ–å‡†å¤‡ã€‚</p><p><img src=/images/jvm-cds-graph.png alt="CDS å›¾è¡¨"></p><p>å›åˆ° CDS çš„è¯é¢˜ï¼Œåœ¨å¤§å¤šæ•°æ­£å¸¸æƒ…å†µä¸‹ï¼ŒJDK ç±»ä¸ä¼šä¸»åŠ¨ç»å†éªŒè¯æ­¥éª¤ã€‚è¿™æ˜¯å› ä¸º CDS æä¾›çš„å¥½å¤„ä¹‹ä¸€æ˜¯å½’æ¡£ä¸­åŒ…å«çš„ç±»å·²ç»è¢«éªŒè¯è¿‡ï¼Œå‡å°‘äº† JVM åœ¨å¯åŠ¨æ—¶éœ€è¦åšçš„å·¥ä½œï¼Œä»è€Œæé«˜äº†å¯åŠ¨æ€§èƒ½ã€‚</p><p>å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äº CDS çš„ä¿¡æ¯ï¼Œå¯ä»¥æŸ¥çœ‹æˆ‘çš„ <a href=https://youtu.be/vvlQv1Dh-HU>Stack Walker è§†é¢‘</a>ã€æˆ‘ä»¬åœ¨ <a href=https://dev.java/learn/jvm/cds-appcds/>dev.java ä¸Šå…³äº CDS çš„æ–‡ç« </a>ï¼Œæˆ–è€…<a href=https://inside.java/2022/09/26/sip067/>è¿™ç¯‡ inside.java æ–‡ç« </a>ï¼Œäº†è§£å¦‚ä½•å°†åº”ç”¨ç¨‹åºçš„ç±»åŒ…å«åœ¨ CDS å½’æ¡£ä¸­ã€‚</p><p>ä¸€ä¸ª<em>ç¡®å®</em>éœ€è¦è¢«éªŒè¯çš„ç±»æ˜¯ <code>HelloWorld</code>ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ—¥å¿—ä¸­çœ‹åˆ° JVM æ­£åœ¨æ‰§è¡Œè¿™ä¸ªæ“ä½œï¼š</p><pre tabindex=0><code>[class,init            ] Start class verification for: HelloWorld
[verification          ] Verifying class HelloWorld with new format
[verification          ] Verifying method HelloWorld.&lt;init&gt;()V
[verification          ] table = {
[verification          ]   }
[verification          ] bci: @0
[verification          ] flags: { flagThisUninit }
[verification          ] locals: { uninitializedThis }
[verification          ] stack: { }
[verification          ] offset = 0,  opcode = aload_0
[verification          ] bci: @1
</code></pre><h4 id=å‡†å¤‡>å‡†å¤‡</h4><p>å‡†å¤‡ï¼ˆ<a href=https://docs.oracle.com/javase/specs/jvms/se23/html/jvms-5.html#jvms-5.4.2>5.4.2</a>ï¼‰å¤„ç†å°†ç±»ä¸­çš„é™æ€å­—æ®µåˆå§‹åŒ–ä¸ºå…¶<em>é»˜è®¤</em>å€¼ã€‚</p><p>ä¸ºäº†æ›´å¥½åœ°ç†è§£è¿™ä¸€ç‚¹ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªç®€å•çš„ç¤ºä¾‹ç±»ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MyClass</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>int</span> myStaticInt <span style=color:#f92672>=</span> 10; <span style=color:#75715e>//Initialized to 0</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>int</span> myStaticInitializedInt; <span style=color:#75715e>//Initialized to 0</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>int</span> myInstanceInt <span style=color:#f92672>=</span> 30; <span style=color:#75715e>//Not initialized</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>static</span> {
</span></span><span style=display:flex><span>    myStaticInitializedInt <span style=color:#f92672>=</span> 20;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>å®ƒåŒ…å«ä¸‰ä¸ªæ•´æ•°å­—æ®µï¼š<code>myStaticInt</code>ã€<code>myStaticInitializedInt</code> å’Œ <code>myInstanceInt</code>ã€‚</p><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>myStaticInt</code> å’Œ <code>myStaticInitializedInt</code> éƒ½ä¼šè¢«åˆå§‹åŒ–ä¸º <code>0</code>ï¼Œè¿™æ˜¯åŸå§‹ <code>int</code> ç±»å‹çš„é»˜è®¤å€¼ã€‚</p><p>è€Œ <code>myInstanceInt</code> ä¸ä¼šè¢«åˆå§‹åŒ–ï¼Œå› ä¸ºå®ƒæ˜¯å®ä¾‹å­—æ®µï¼Œä¸æ˜¯ç±»å­—æ®µã€‚</p><p>æˆ‘ä»¬ç¨åä¼šä»‹ç» <code>myStaticInt</code>ã€<code>myStaticInitializedInt</code> å­—æ®µä½•æ—¶è¢«åˆå§‹åŒ–ä¸º <code>10</code> å’Œ <code>20</code> çš„å€¼ã€‚</p><h4 id=è§£æ>è§£æ</h4><p>è§£æï¼ˆ<a href=https://docs.oracle.com/javase/specs/jvms/se23/html/jvms-5.html#jvms-5.4.3>5.4.3</a>ï¼‰çš„ç›®æ ‡æ˜¯è§£æç±»çš„å¸¸é‡æ± ä¸­çš„ç¬¦å·å¼•ç”¨ï¼Œä¾› JVM æŒ‡ä»¤ä½¿ç”¨ã€‚</p><p>ä¸ºäº†æ›´å¥½åœ°ç†è§£è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ <code>javap</code> <a href=https://docs.oracle.com/en/java/javase/23/docs/specs/man/javap.html>å·¥å…·</a>ã€‚è¿™æ˜¯ä¸€ä¸ªæ ‡å‡†çš„ JDK å‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºåæ±‡ç¼– Java <code>.class</code> æ–‡ä»¶ã€‚ä½¿ç”¨ <code>-verbose</code> é€‰é¡¹è¿è¡Œå®ƒå°†æä¾›ä¸€ä¸ª JVM å¦‚ä½•è§£é‡Šå®ƒæ­£åœ¨åŠ è½½çš„ç±»çš„è§†å›¾ã€‚è®©æˆ‘ä»¬åœ¨ <code>MyClass</code> ä¸Šè¿è¡Œ <code>javap</code>ï¼š</p><pre tabindex=0><code>$ javap â€“verbose MyClass
class MyClass {
  static int myStaticInt = 10; //Initialized to 0
  static int myStaticInitializedInt; //Initialized to 0
  int myInstanceInt = 30; //Not initialized
  static {
    myStaticInitializedInt = 20;
  }
}
</code></pre><p>è¿™ä¸ªå‘½ä»¤çš„ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre tabindex=0><code>Constant pool:
   #1 = Methodref          #2.#3          // java/lang/Object.&#34;&lt;init&gt;&#34;:()V
   #2 = Class              #4             // java/lang/Object
   #3 = NameAndType        #5:#6          // &#34;&lt;init&gt;&#34;:()V
   #4 = Utf8               java/lang/Object
   #5 = Utf8               &lt;init&gt;
   #6 = Utf8               ()V
   #7 = Fieldref           #8.#9          // MyClass.myInstanceInt:I
   #8 = Class              #10            // MyClass
   #9 = NameAndType        #11:#12        // myInstanceInt:I
  #10 = Utf8               MyClass
  #11 = Utf8               myInstanceInt
  #12 = Utf8               I
  #13 = Fieldref           #8.#14         // MyClass.myStaticInt:I
  #14 = NameAndType        #15:#12        // myStaticInt:I
  #15 = Utf8               myStaticInt
  #16 = Fieldref           #8.#17         // MyClass.myStaticInitializedInt:I
  #17 = NameAndType        #18:#12        // myStaticInitializedInt:I
  #18 = Utf8               myStaticInitializedInt
  #19 = Utf8               Code
  #20 = Utf8               LineNumberTable
  #21 = Utf8               &lt;clinit&gt;
  #22 = Utf8               SourceFile
  #23 = Utf8               MyClass.java
{
  static int myStaticInt;
    descriptor: I
    flags: (0x0008) ACC_STATIC

  static int myStaticInitializedInt;
    descriptor: I
    flags: (0x0008) ACC_STATIC

  int myInstanceInt;
    descriptor: I
    flags: (0x0000)

  MyClass();
    descriptor: ()V
    flags: (0x0000)
    Code:
      stack=2, locals=1, args_size=1
         0: aload_0
         1: invokespecial #1                  // Method java/lang/Object.&#34;&lt;init&gt;&#34;:()V
         4: aload_0
         5: bipush        30
         7: putfield      #7                  // Field myInstanceInt:I
        10: return
      LineNumberTable:
        line 1: 0
        line 4: 4

  static {};
    descriptor: ()V
    flags: (0x0008) ACC_STATIC
    Code:
      stack=1, locals=0, args_size=0
         0: bipush        10
         2: putstatic     #13                 // Field myStaticInt:I
         5: bipush        20
         7: putstatic     #16                 // Field myStaticInitializedInt:I
        10: return
      LineNumberTable:
        line 2: 0
        line 6: 5
        line 7: 10
}
</code></pre><p><strong>ğŸ’¡ æ³¨æ„ï¼š</strong> è¿™ä¸ªè¾“å‡ºå·²ç»ç¨å¾®æˆªæ–­ï¼Œåˆ é™¤äº†ä¸æœ¬æ–‡æ— å…³çš„å…ƒæ•°æ®ã€‚</p><p>è¿™é‡Œæœ‰å¾ˆå¤šå†…å®¹ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬åˆ†è§£ä¸€ä¸‹ï¼Œé€æ­¥äº†è§£è¿™ä¸€åˆ‡çš„å«ä¹‰ã€‚</p><p>ä¸‹é¢çš„éƒ¨åˆ†æ˜¯ <code>MyClass</code> çš„ï¼ˆè‡ªåŠ¨ç”Ÿæˆçš„ï¼‰é»˜è®¤æ„é€ å‡½æ•°ï¼Œå®ƒä»è°ƒç”¨ <code>MyClass</code> çš„çˆ¶ç±» <code>java.lang.Object</code> çš„é»˜è®¤æ„é€ å‡½æ•°å¼€å§‹ï¼Œç„¶åå°† <code>myInstanceInt</code> è®¾ç½®ä¸ºå…¶åˆ†é…çš„å€¼ <code>30</code>ã€‚</p><pre tabindex=0><code>MyClass();
  descriptor: ()V
  flags: (0x0000)
  Code:
    stack=2, locals=1, args_size=1
      0: aload_0
      1: invokespecial #1 //Method java/lang/Object.&#34;&lt;init&gt;&#34;:()V
      4: aload_0
      5: bipush    30
      7: putfield  #7 //Field myInstanceInt:I
      10: return
  LineNumberTable:
    line 1: 0
    line 4: 4
</code></pre><p><strong>ğŸ’¡ æ³¨æ„ï¼š</strong> æ¯«æ— ç–‘é—®ï¼Œä½ ä¼šæ³¨æ„åˆ° <code>aload_0</code>ã€<code>invokespecial</code>ã€<code>bipush</code>ã€<code>putfield</code> ç­‰ç­‰ã€‚è¿™äº›æ˜¯ <a href=https://docs.oracle.com/javase/specs/jvms/se7/html/jvms-6.html>JVM æŒ‡ä»¤</a>ï¼Œæ˜¯ JVM ç”¨äºå®é™…æ‰§è¡Œå…¶å·¥ä½œçš„<a href=https://en.wikipedia.org/wiki/Opcode>æ“ä½œç </a>ã€‚</p><p>åœ¨ <code>invokespecial</code> å’Œ <code>putfield</code> çš„å³ä¾§ï¼Œæœ‰æ•°å­— <code>#1</code> å’Œ <code>#7</code>ã€‚è¿™äº›æ˜¯å¯¹ <code>MyClass</code> çš„å¸¸é‡æ± ï¼ˆ<a href=https://docs.oracle.com/javase/specs/jvms/se23/html/jvms-4.html#jvms-4.4>4.4</a>ï¼‰çš„å¼•ç”¨ã€‚è®©æˆ‘ä»¬ä»”ç»†çœ‹çœ‹å®ƒï¼š</p><pre tabindex=0><code>Constant pool:
   #1 = Methodref          #2.#3          // java/lang/Object.&#34;&lt;init&gt;&#34;:()V
   #2 = Class              #4             // java/lang/Object
   #3 = NameAndType        #5:#6          // &#34;&lt;init&gt;&#34;:()V
   #4 = Utf8               java/lang/Object
   #5 = Utf8               &lt;init&gt;
   #6 = Utf8               ()V
   #7 = Fieldref           #8.#9          // MyClass.myInstanceInt:I
   #8 = Class              #10            // MyClass
   #9 = NameAndType        #11:#12        // myInstanceInt:I
  #10 = Utf8               MyClass
  #11 = Utf8               myInstanceInt
  #12 = Utf8               I
  #13 = Fieldref           #8.#14         // MyClass.myStaticInt:I
  #14 = NameAndType        #15:#12        // myStaticInt:I
  #15 = Utf8               myStaticInt
  #16 = Fieldref           #8.#17         // MyClass.myStaticInitializedInt:I
  #17 = NameAndType        #18:#12        // myStaticInitializedInt:I
  #18 = Utf8               myStaticInitializedInt
  #19 = Utf8               Code
  #20 = Utf8               LineNumberTable
  #21 = Utf8               &lt;clinit&gt;
  #22 = Utf8               SourceFile
  #23 = Utf8               MyClass.java
</code></pre><p><code>MyClass</code> å¸¸é‡æ± ä¸­åŒ…å«äº†å®ƒçš„æ‰€æœ‰ç¬¦å·å¼•ç”¨ã€‚ä¸ºäº†è®© JVM æ‰§è¡Œ <code>invokespecial</code> JVM æŒ‡ä»¤ï¼Œå®ƒéœ€è¦<em>è§£æ</em>åˆ° <code>java.lang.Object</code> é»˜è®¤æ„é€ å‡½æ•°çš„é“¾æ¥ã€‚å‚è€ƒå¸¸é‡æ± ï¼Œæ¡ç›® 1-6 æä¾›äº†å½¢æˆæ­¤é“¾æ¥æ‰€éœ€çš„ä¿¡æ¯ã€‚</p><p><strong>ğŸ’¡ æ³¨æ„ï¼š</strong> <code>&lt;init></code> æ˜¯ <code>javac</code> ä¸ºç±»ä¸­çš„æ¯ä¸ªæ„é€ å‡½æ•°è‡ªåŠ¨ç”Ÿæˆçš„ç‰¹æ®Šæ–¹æ³•ã€‚</p><p>è¿™ç§æ¨¡å¼åœ¨ <code>putfield</code> ä¸­ä¹Ÿé‡å¤å‡ºç°ï¼Œå®ƒå¼•ç”¨å¸¸é‡æ± æ¡ç›® 7ï¼Œä¸æ¡ç›® 8-12 ç»“åˆæ—¶ï¼Œæä¾›äº†è§£æè®¾ç½® <code>myInstanceInt</code> é“¾æ¥æ‰€éœ€çš„å¿…è¦ä¿¡æ¯ã€‚æœ‰å…³å¸¸é‡æ± çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ <a href=https://docs.oracle.com/javase/specs/jvms/se23/html/jvms-4.html#jvms-4.4>JVM è§„èŒƒä¸­å…³äºå®ƒçš„éƒ¨åˆ†</a>ã€‚</p><p>è§£æè¿‡ç¨‹å¯ä»¥ä»éªŒè¯ä¹‹å‰åˆ°ç±»åˆå§‹åŒ–ä¹‹åçš„ä»»ä½•æ—¶é—´å‘ç”Ÿçš„åŸå› æ˜¯ï¼Œå®ƒæ˜¯æƒ°æ€§æ‰§è¡Œçš„ï¼Œåªæœ‰å½“ JVM å°è¯•æ‰§è¡Œç±»ä¸­çš„ JVM æŒ‡ä»¤æ—¶æ‰ä¼šå‘ç”Ÿã€‚å¹¶éæ‰€æœ‰åŠ è½½çš„ç±»éƒ½ä¼šæ‰§è¡Œ JVM æŒ‡ä»¤ã€‚ä¾‹å¦‚ï¼Œ<code>java.lang.SecurityManager</code> ç±»è¢«åŠ è½½ä½†ä»æœªè§¦åŠï¼Œ<a href=https://openjdk.org/jeps/486>å› ä¸ºå®ƒå³å°†è¢«æ·˜æ±°</a>ã€‚ç±»ä¸­ä¹Ÿå¯èƒ½æ²¡æœ‰ä»»ä½•éœ€è¦åˆå§‹åŒ–çš„å†…å®¹ï¼ŒJVM ä¼šè‡ªåŠ¨å°†å…¶æ ‡è®°ä¸ºå·²åˆå§‹åŒ–ã€‚è¯´åˆ°ç±»åˆå§‹åŒ–â€¦â€¦</p><h3 id=ç±»åˆå§‹åŒ–>ç±»åˆå§‹åŒ–</h3><p>æœ€åæ˜¯ç±»åˆå§‹åŒ–ï¼Œåœ¨ <a href=https://docs.oracle.com/javase/specs/jvms/se23/html/jvms-5.html#jvms-5.5>JVM è§„èŒƒç¬¬ 5.5 èŠ‚</a>ä¸­æœ‰è¯¦ç»†è¯´æ˜ã€‚ç±»åˆå§‹åŒ–æ¶‰åŠä¸ºé™æ€å­—æ®µåˆ†é… <code>ConstantValue</code>ï¼Œå¹¶æ‰§è¡Œç±»ä¸­å­˜åœ¨çš„ä»»ä½•é™æ€åˆå§‹åŒ–å™¨ï¼ˆå¦‚æœå­˜åœ¨ï¼‰ã€‚å½“ JVM åœ¨ç±»ä¸Šè°ƒç”¨ <code>new</code>ã€<code>getstatic</code>ã€<code>putstatic</code> æˆ– <code>invokestatic</code> JVM æŒ‡ä»¤ä¸­çš„ä»»ä½•ä¸€ä¸ªæ—¶ï¼Œå®ƒå°±ä¼šå¯åŠ¨ã€‚</p><p>ç±»çš„åˆå§‹åŒ–ç”±ç‰¹æ®Šçš„æ— å‚æ•°æ–¹æ³• <code>void &lt;clinit></code> å¤„ç†ï¼Œåƒ <code>&lt;init></code> ä¸€æ ·ï¼Œå®ƒç”± <code>javac</code> è‡ªåŠ¨ç”Ÿæˆã€‚è§’æ‹¬å·ï¼ˆ<code>&lt; ></code>ï¼‰çš„åŒ…å«æ˜¯æœ‰æ„çš„ï¼Œå› ä¸ºå®ƒä»¬å¯¹äºæ–¹æ³•åç§°ä¸æ˜¯æœ‰æ•ˆçš„å­—ç¬¦ï¼Œå› æ­¤é˜²æ­¢ Java ç”¨æˆ·ç¼–å†™è‡ªå·±çš„è‡ªå®šä¹‰ <code>&lt;init></code> æˆ– <code>&lt;clinit></code> æ–¹æ³•ã€‚</p><p>ä¸èƒ½ä¿è¯æ€»æ˜¯åˆ›å»º <code>&lt;clinit></code> æ–¹æ³•ï¼Œå› ä¸ºå®ƒåªåœ¨ç±»ä¸­æœ‰é™æ€åˆå§‹åŒ–å™¨æˆ–å­—æ®µæ—¶æ‰éœ€è¦ã€‚å¦‚æœä¸€ä¸ªç±»ä¸¤è€…éƒ½æ²¡æœ‰ï¼Œé‚£ä¹ˆä¸ä¼šç”Ÿæˆ <code>&lt;clinit></code>ï¼Œå¦‚æœåœ¨å…¶ä¸Šè°ƒç”¨ <code>new</code>ï¼ŒJVM ä¼šç«‹å³å°†è¯¥ç±»æ ‡è®°ä¸ºå·²åˆå§‹åŒ–ï¼Œå®é™…ä¸Šè·³è¿‡äº†ç±»åˆå§‹åŒ–ï¼Œè¿™å°±æ˜¯è§£æå¦‚ä½•å¯ä»¥åœ¨ç±»åˆå§‹åŒ–<em>ä¹‹å</em>å‘ç”Ÿã€‚</p><p>ç”±äº <code>MyClass</code> ç¡®å®æœ‰ä¸¤ä¸ªé™æ€å­—æ®µå’Œä¸€ä¸ªé™æ€åˆå§‹åŒ–å™¨å—ï¼Œå®ƒç¡®å®æœ‰ä¸€ä¸ª <code>&lt;clinit></code> æ–¹æ³•ï¼Œå›åˆ° <code>javap</code> çš„è¾“å‡ºï¼š</p><pre tabindex=0><code>  static {};
    descriptor: ()V
    flags: (0x0008) ACC_STATIC
    Code:
      stack=1, locals=0, args_size=0
         0: bipush        10
         2: putstatic     #13                 // Field myStaticInt:I
         5: bipush        20
         7: putstatic     #16                 // Field myStaticInitializedInt:I
        10: return
      LineNumberTable:
        line 2: 0
        line 6: 5
        line 7: 10
</code></pre><p><code>&lt;clinit></code> çš„ç»“æ„ç±»ä¼¼äº <code>&lt;init></code>ï¼Œä½†æ²¡æœ‰è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°ï¼Œå¹¶ä¸”ä½¿ç”¨äº† <code>putstatic</code> ç­‰ JVM æŒ‡ä»¤è€Œä¸æ˜¯ <code>putfield</code>ã€‚</p><h2 id=hello-world>Hello World!</h2><p>æœ€ç»ˆï¼ŒJVM å°†å®Œæˆè¶³å¤Ÿçš„å‡†å¤‡å·¥ä½œï¼Œå¼€å§‹æ‰§è¡Œ <code>public static void main()</code> ä¸­çš„ç”¨æˆ·ä»£ç ï¼Œæˆ‘ä»¬çš„ <code>Hello World!</code> æ¶ˆæ¯å°±ä½äºé‚£é‡Œï¼š</p><pre tabindex=0><code>[0.062s][debug][class,resolve] java.io.FileOutputStream
...
Hello World!
</code></pre><p>æ€»å…±ï¼ŒJVM ä¼šåŠ è½½å¤§çº¦ 450 ä¸ªç±»ï¼Œå…¶ä¸­ä¸€éƒ¨åˆ†ä¹Ÿä¼šè¢«é“¾æ¥å’Œåˆå§‹åŒ–ã€‚åœ¨æˆ‘çš„ M4 MacBook Pro ä¸Šï¼Œæ­£å¦‚æ—¥å¿—ä¸­æ‰€è§ï¼Œæ•´ä¸ªè¿‡ç¨‹åªç”¨äº† 62 æ¯«ç§’ï¼Œå³ä½¿åœ¨æ‰§è¡Œéå¸¸ç¹é‡çš„æ—¥å¿—è®°å½•æ—¶ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ä½ å¯ä»¥åœ¨æˆ‘çš„ <a href=https://gist.github.com/wkorando/34294017e1c7653ab9f9ed5c02f017a3>GitHub è¿™é‡Œ</a>æŸ¥çœ‹å®Œæ•´çš„æ—¥å¿—ã€‚</p><h2 id=project-leyden>Project Leyden</h2><p>ç°åœ¨å®é™…ä¸Šæ˜¯ JVM å¯åŠ¨çš„ä¸€ä¸ªéå¸¸ä»¤äººå…´å¥‹çš„æ—¶æœŸã€‚è™½ç„¶æ¯ä¸ª JDK ç‰ˆæœ¬éƒ½åœ¨ä¸æ–­æ”¹è¿›å¯åŠ¨è¿‡ç¨‹ï¼Œä½†ä» JDK 24 å¼€å§‹ï¼Œæ¥è‡ª <a href=https://openjdk.org/projects/leyden/>Project Leyden</a> çš„ç¬¬ä¸€ä¸ªç‰¹æ€§å°†è¢«åˆå¹¶åˆ°ä¸»çº¿ JDK ç‰ˆæœ¬ä¸­ã€‚</p><p>Project Leyden çš„ç›®æ ‡æ˜¯å‡å°‘ï¼šå¯åŠ¨æ—¶é—´ã€è¾¾åˆ°å³°å€¼æ€§èƒ½çš„æ—¶é—´å’Œå†…å­˜å ç”¨ï¼Œå¹¶ä¸”æ˜¯åŸºäº CDS å®Œæˆçš„å·¥ä½œæ„å»ºå¹¶å–ä»£å®ƒçš„ã€‚éšç€ Project Leyden çš„é›†æˆï¼ŒCDS å°†è¢« AOTï¼ˆahead-of-timeï¼Œæå‰ç¼–è¯‘ï¼‰å–ä»£ã€‚Project Leyden çš„åŠŸèƒ½å°†é€šè¿‡åœ¨è®­ç»ƒè¿è¡ŒæœŸé—´è®°å½• JVM çš„è¡Œä¸ºï¼Œå°†è¯¥ä¿¡æ¯å­˜å‚¨åœ¨ç¼“å­˜ä¸­ï¼Œç„¶ååœ¨åç»­å¯åŠ¨æ—¶ä»è¯¥ç¼“å­˜åŠ è½½æ¥å·¥ä½œã€‚å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äº Project Leyden çš„ä¿¡æ¯ï¼Œè¯·åŠ¡å¿…æŸ¥çœ‹<a href=https://youtu.be/z9XgILeSwzk>è¿™ä¸ªè§†é¢‘</a>ã€‚</p><p>Project Leyden çš„é¢†å…ˆåŠŸèƒ½å°†æ˜¯ <a href=https://openjdk.org/jeps/483>JEP 483: Ahead-of-Time Class Loading & Linking</a>ã€‚æˆ‘ä»¬åœ¨æœ¬æ–‡ä¸­å·²ç»ä»‹ç»äº†ç±»åŠ è½½å’Œé“¾æ¥ï¼Œå› æ­¤æå‰æ‰§è¡Œè¯¥å·¥ä½œè€Œä¸æ˜¯åœ¨å¯åŠ¨æ—¶æ‰§è¡Œçš„å¥½å¤„ç°åœ¨åº”è¯¥ç›¸å½“æ¸…æ¥šäº†ã€‚</p><h2 id=ç»“è®º>ç»“è®º</h2><p>æ­£å¦‚æœ¬æ–‡æ‰€è¿°ï¼ŒJVM å¯åŠ¨è¿‡ç¨‹æ˜¯ä¸€ä¸ªå¤æ‚çš„è¿‡ç¨‹ã€‚å“åº”å¯ç”¨ç³»ç»Ÿèµ„æºã€æä¾›æ£€æŸ¥å’Œåˆ†æ JVM çš„æ‰‹æ®µã€åŠ¨æ€åŠ è½½ç±»ç­‰èƒ½åŠ›ï¼Œç¡®å®å¸¦æ¥äº†ç›¸å½“å¤§çš„å¤æ‚æ€§å¼€é”€ã€‚</p><p>é‚£ä¹ˆï¼Œé™¤äº†å¯¹ JVM æœ‰æ›´æ·±å…¥çš„äº†è§£ä¹‹å¤–ï¼Œè¿˜èƒ½ä»ä¸­å¾—åˆ°ä»€ä¹ˆï¼Ÿæœ‰ä¸¤ç‚¹å€¼å¾—æŒ‡å‡ºï¼Œè°ƒè¯•å’Œæ€§èƒ½ï¼Œå°½ç®¡å®ƒä»¬çš„é€‚ç”¨æ€§å¯èƒ½ä¹Ÿæœ‰äº›ç‹­çª„ã€‚</p><h3 id=è°ƒè¯•>è°ƒè¯•</h3><p>JVM å¯åŠ¨è¿‡ç¨‹éå¸¸å¯é ï¼Œé€šå¸¸å½“é”™è¯¯å‘ç”Ÿæ—¶ï¼Œå…¶åŸå› å¾€å¾€æ˜¯æ˜æ˜¾çš„ç”¨æˆ·é”™è¯¯ï¼Œæˆ–è€…å¯èƒ½æ˜¯ç¬¬ä¸‰æ–¹åº“ä¸­çš„é—®é¢˜ã€‚å¸Œæœ›å¯¹ JVM è¯•å›¾åšä»€ä¹ˆä»¥åŠä¸ºä»€ä¹ˆè¿™æ ·åšæœ‰æ›´æ·±å…¥çš„äº†è§£ï¼Œå¯ä»¥ä¸ºé‚£äº›æ›´æŒä¹…æˆ–éš¾ä»¥ç†è§£çš„å¯åŠ¨é—®é¢˜æä¾›ä¸€äº›æ›´å¥½çš„æŒ‡å¯¼ã€‚</p><h3 id=æ€§èƒ½æ”¹è¿›>æ€§èƒ½æ”¹è¿›</h3><p>å¦ä¸€ä¸ªæ½œåœ¨çš„å¥½å¤„æ˜¯ï¼Œæœ‰äº†è¿™äº›çŸ¥è¯†ï¼Œä½ å¯èƒ½ä¼šæ‰¾åˆ°ä¸€äº›å°æœºä¼šæ¥æé«˜åº”ç”¨ç¨‹åºçš„å¯åŠ¨æ€§èƒ½ã€‚ç‰¹åˆ«æ˜¯éšç€ JEP 483 åœ¨ JDK 24 ä¸­é›†æˆï¼Œæœªæ¥ç±»åŠ è½½å’Œé“¾æ¥è¡Œä¸ºå¯ä»¥è¿›ä¸€æ­¥æé«˜å¯åŠ¨æ€§èƒ½ã€‚ä¸è¿‡æˆ‘ä¹Ÿè¦æé†’çš„æ˜¯ï¼Œåœ¨å¤§å¤šæ•°ç”¨ä¾‹ä¸­ï¼Œä½ ç¼–å†™çš„ç¬¬ä¸€æ–¹ä»£ç é€šå¸¸åªæ˜¯åœ¨ JVM ä¸Šè¿è¡Œçš„ä»£ç çš„å¾ˆå°ä¸€éƒ¨åˆ†ã€‚åœ¨åº“ã€æ¡†æ¶å’Œ JDK æœ¬èº«ä¹‹é—´ï¼Œæ„æˆåº”ç”¨ç¨‹åºçš„ä»£ç é€šå¸¸åªæ˜¯å†°å±±ä¸€è§’ã€‚</p><p><img src=/images/jvm-code-pyramid.png alt=ä»£ç é‡‘å­—å¡”></p></div><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//douglarek.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a><footer class=content__footer></footer></section><section class=page__aside><div class=aside__content><p>2025-12-09</p><hr>On this page:<nav id=TableOfContents><ul><li><a href=#å‰è¨€>å‰è¨€</a></li><li><a href=#jvm-åˆå§‹åŒ–>JVM åˆå§‹åŒ–</a><ul><li><a href=#éªŒè¯ç”¨æˆ·è¾“å…¥>éªŒè¯ç”¨æˆ·è¾“å…¥</a></li><li><a href=#æ£€æµ‹ç³»ç»Ÿèµ„æº>æ£€æµ‹ç³»ç»Ÿèµ„æº</a></li><li><a href=#å‡†å¤‡ç¯å¢ƒ>å‡†å¤‡ç¯å¢ƒ</a></li><li><a href=#é€‰æ‹©åƒåœ¾æ”¶é›†å™¨>é€‰æ‹©åƒåœ¾æ”¶é›†å™¨</a></li><li><a href=#cds>CDS</a></li><li><a href=#åˆ›å»ºæ–¹æ³•åŒº>åˆ›å»ºæ–¹æ³•åŒº</a></li></ul></li><li><a href=#ç±»åŠ è½½é“¾æ¥å’Œåˆå§‹åŒ–>ç±»åŠ è½½ã€é“¾æ¥å’Œåˆå§‹åŒ–</a><ul><li><a href=#ç±»åŠ è½½>ç±»åŠ è½½</a></li><li><a href=#ç±»é“¾æ¥>ç±»é“¾æ¥</a></li><li><a href=#ç±»åˆå§‹åŒ–>ç±»åˆå§‹åŒ–</a></li></ul></li><li><a href=#hello-world>Hello World!</a></li><li><a href=#project-leyden>Project Leyden</a></li><li><a href=#ç»“è®º>ç»“è®º</a><ul><li><a href=#è°ƒè¯•>è°ƒè¯•</a></li><li><a href=#æ€§èƒ½æ”¹è¿›>æ€§èƒ½æ”¹è¿›</a></li></ul></li></ul></nav></div></section><footer class=page__footer><p></p><br><br><p class=copyright>Copyright Â© 2025 Leo Douglas</p></footer></div></body></html>